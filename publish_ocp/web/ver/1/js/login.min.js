var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r["throw"](t))}catch(e){i(e)}}function c(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}c((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(r){n=[6,r],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},qmr;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._eventDic={},t._notifyDic={},t._unpackDic={},t._unpackDynamic={},t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.onCreationComplete,t),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.addedToStage,t),t}return __extends(n,e),n.prototype.onCreationComplete=function(t){this.initComponent(),this.isSkinLoaded=!0,this.initListener(),this.initData(),this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onCreationComplete,this)},n.prototype.initUnpackRes=function(t){var e=this,n=t.numChildren;t instanceof eui.Component&&t.skin instanceof eui.Skin&&e.initStatesUnpackRes(t.skin,t);for(var r=0;n>r;r++){var o=t.getChildAt(r);if(o instanceof egret.DisplayObjectContainer)e.initUnpackRes(o);else if(o instanceof eui.Image){var i=o.source;if("string"==typeof i&&""!=i){var a=RES.getResourceInfo(i);a&&"unpack"==a.url.substr(0,6)&&e.addUnpackRef(i,o)}}}},n.prototype.initStatesUnpackRes=function(t,e){for(var n=this,r=t.currentState,o=0,i=t.states;o<i.length;o++){var a=i[o];if(a.name!=r)for(var s=0,c=a.overrides;s<c.length;s++){var l=c[s];if(l instanceof eui.SetProperty){if("source"==l.name){var u=l.value;if("string"==typeof u&&""!=u){var p=RES.getResourceInfo(u);if(p&&"unpack"==p.url.substr(0,6)){var f=e[l.target];f instanceof eui.Image&&n.addUnpackRef(u,f)}}}}else if(l instanceof eui.AddItems){var g=e[l.target];if(g||(g=t[l.target]),g instanceof eui.Image){var u=g.source;if("string"==typeof u&&""!=u){var p=RES.getResourceInfo(u);p&&"unpack"==p.url.substr(0,6)&&n.addUnpackRef(u,g)}}}}}},n.prototype.addUnpackRef=function(t,e){var n=this,r=n._unpackDic[t];r?r.push(e):n._unpackDic[t]=[e]},n.prototype.addedToStage=function(t){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},n.prototype.removeFromStage=function(t){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},n.prototype.initComponent=function(){},n.prototype.initData=function(){this.onStageResize();var e=this._unpackDic;for(var n in e){if(!RES.getRes(n)){var r=e[n];if(r)for(var o=0,i=r;o<i.length;o++){var a=i[o];a.source=null,a.source=n}}t.LoaderManager.instance.addGroupRef(n)}},Object.defineProperty(n.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!0,configurable:!0}),n.prototype.initListener=function(){},n.prototype.onStageResize=function(){},n.prototype.registerNotify=function(e,n,r){void 0===r&&(r=null),r=r?r:this,this._notifyDic[e]={callBack:n,thisObject:r},t.NotifyManager.registerNotify(e,n,r)},n.prototype.unRegisterNotify=function(e,n,r){void 0===r&&(r=null),r=r?r:this;var o=this._notifyDic[e];o&&o.callback==n&&o.thisObject==r&&delete this._notifyDic[e],t.NotifyManager.unRegisterNotify(e,n,r)},n.prototype.unRegisterAllNotify=function(){var e,n=this._notifyDic;for(var r in n)e=n[r],e&&t.NotifyManager.unRegisterNotify(r,e.callBack,e.thisObject),delete n[r];this._notifyDic={}},n.prototype.dispatch=function(e,n){void 0===n&&(n=null),t.NotifyManager.sendNotification(e,n)},n.prototype.addEvent=function(t,e,n,r){void 0===r&&(r=null),r=r?r:this;var o={};o.target=t,o.type=e,o.callBack=n,o.thisObject=r,t&&(t.addEventListener(e,n,r),this._eventDic[t.hashCode+e]=o)},n.prototype.addClickEvent=function(t,e,n){void 0===n&&(n=null);var r=this,o=r._eventDic,i=1,a=1;if(n=n?n:r,t instanceof eui.Group&&(t.touchChildren=!1),t instanceof egret.DisplayObject){if(0==t.anchorOffsetX&&0==t.anchorOffsetY){var s=t.width/2,c=t.height/2;t.anchorOffsetX=s,t.anchorOffsetY=c,t.x+=s,t.y+=c}i=t.scaleX,a=t.scaleY}var l={};l.target=t,l.scaleX=i,l.scaleY=a,l.type=egret.TouchEvent.TOUCH_BEGIN,l.thisObject=n,l.callFunc=r.onTouchBegin,l.thisCall=r,t&&(t.addEventListener(l.type,r.onTouchBegin,r),o[t.hashCode+l.type]=l);var u={};u.target=t,u.scaleX=i,u.scaleY=a,u.type=egret.TouchEvent.TOUCH_END,u.callBack=e,u.thisObject=n,u.callFunc=r.onTouchEnd,u.thisCall=r,t&&(t.addEventListener(u.type,r.onTouchEnd,r),o[t.hashCode+u.type]=u);var p={};p.target=t,p.scaleX=i,p.scaleY=a,p.type=egret.TouchEvent.TOUCH_TAP,p.callBack=e,p.thisObject=n,p.callFunc=r.onTouchEnd,p.thisCall=r,t&&(t.addEventListener(p.type,r.onTouchEnd,r),o[t.hashCode+p.type]=p);var f={};f.target=t,f.scaleX=i,f.scaleY=a,f.type=egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,f.thisObject=n,f.callFunc=r.onTouchReleaseOutSide,f.thisCall=r,t&&(t.addEventListener(f.type,r.onTouchReleaseOutSide,r),o[t.hashCode+f.type]=f);var g={};g.target=t,g.scaleX=i,g.scaleY=a,g.type=egret.TouchEvent.TOUCH_CANCEL,g.thisObject=n,g.callFunc=r.onTouchReleaseOutSide,g.thisCall=r,t&&(t.addEventListener(g.type,r.onTouchReleaseOutSide,r),o[t.hashCode+g.type]=f)},n.prototype.onTouchBegin=function(t){var e=t.target,n=e.hashCode,r=this._eventDic[n+t.type];this._touchBeginTaret=e,egret.Tween.removeTweens(e),egret.Tween.get(e).to({scaleX:.9*r.scaleX,scaleY:.9*r.scaleY},50),this.loadAndPlayEffect("SOUND_DIANJI")},n.prototype.onTouchEnd=function(t){var e=this,n=t.target,r=e._eventDic;if(e._touchBeginTaret==n){e._touchBeginTaret=null;var o=r[n.hashCode+t.type],i=o.scaleX,a=o.scaleY;egret.Tween.get(n).to({scaleX:i,scaleY:a},50).call(function(){for(var t in r){var e=r[t];e.target==n&&e.type==egret.TouchEvent.TOUCH_END&&e.callBack.call(e.thisObject,n)}},e)}},n.prototype.onTouchReleaseOutSide=function(t){var e=this;if(e._touchBeginTaret==t.target){e._touchBeginTaret=null;var n=e._eventDic[t.target.hashCode+t.type];n&&(t.target.scaleX=n.scaleX,t.target.scaleY=n.scaleY)}},n.prototype.removeAllEvent=function(){var t,e,n=this._eventDic;for(var r in n)t=n[r],e=t.target,null!=e&&(t.type!=egret.TouchEvent.TOUCH_TAP||e instanceof egret.Stage||(void 0!=t.scaleX&&(e.scaleX=t.scaleX),void 0!=t.scaleY&&(e.scaleY=t.scaleY)),e.removeEventListener(t.type,t.callBack,t.thisObject),e.removeEventListener(t.type,t.callFunc,t.thisCall)),delete n[r];this._eventDic={}},n.prototype.updateTitle=function(e,n){e||n>0?t.NotifyManager.sendNotification(t.NotifyConstLogin.UPDATE_MODULE_TITLE,{title:e,ruleId:n}):e||void 0!=n||t.NotifyManager.sendNotification(t.NotifyConstLogin.UPDATE_MODULE_TITLE,{ruleId:0})},n.prototype.loadAndPlayEffect=function(e,n,r){void 0===n&&(n=1),void 0===r&&(r=!1),t.SoundManager.getInstance().loadAndPlayEffect(e,n,r)},n.prototype.stopSoundEffect=function(e){t.SoundManager.getInstance().stopSoundEffect(e)},n.prototype.addUnpackRes=function(e){var n=this._unpackDynamic;if("string"==typeof e)n[e]||(n[e]=!0,t.LoaderManager.instance.addGroupRef(e));else for(var r=0,o=e;r<o.length;r++){var i=o[r];n[i]||(n[i]=!0,t.LoaderManager.instance.addGroupRef(i))}},n.prototype.destoryUnpackRes=function(){for(var e in this._unpackDic)t.LoaderManager.instance.destoryGroup(e);for(var e in this._unpackDynamic)t.LoaderManager.instance.destoryGroup(e);this._unpackDynamic={}},n.prototype.dispose=function(e){void 0===e&&(e=!1);var n=this;n.destoryUnpackRes(),n.removeAllEvent(),n.unRegisterAllNotify(),n._touchBeginTaret=null,n._data=null,n.parent&&n.parent.removeChild(n),t.ModuleManager.openPanelFromBattle&&(t.ModuleManager.openPanelFromBattle=!1)},n}(eui.Component);t.UIComponent=e,__reflect(e.prototype,"qmr.UIComponent")}(qmr||(qmr={}));var qmr;!function(t){var e=function(e){function n(t,n){void 0===t&&(t=null),void 0===n&&(n=null);var r=e.call(this)||this;return r._scale=1,r._offsetX=0,r._offsetY=0,r._effectWidth=0,r.callBack=t,r.thisObject=n,r.isDirLoad=!1,r.actList=[],r.isBody=!1,r.pixelHitTest=!0,r.offsetX=0,r.offsetY=0,r.curFrame=0,r}return __extends(n,e),n.prototype.setIsDirLoad=function(t){this.isDirLoad=t},n.prototype.getIsDirLoad=function(){return this.isDirLoad},n.prototype.setActs=function(t){this.actList=t.split(",")},n.prototype.containsAct=function(t){var e=this.actList;if(0==e.length)return!0;for(var n=0,r=e;n<r.length;n++){var o=r[n];if(o==t)return!0}return!1},n.prototype.load=function(e,n,r){void 0===r&&(r=-1);var o=this,i=t.AnimateManager.getInstance();o.curFrame=0,o.animateData&&o.resName&&i.dispos(o.resName),o.resName=n;var a=i.getAnimalData(o.resName,o.isDirLoad?-1:r);if(a)o.animateData=a,o.callBack&&egret.callLater(o.callBack,o.thisObject,!0,n);else{var s=function(a){var s=function(t,e){if(t){var s=n;i.parseSpriteSheet(s,e,a,t,r),s==o.resName&&(o.animateData=i.getAnimalData(s,r)),o.callBack&&egret.callLater(o.callBack,o.thisObject,!1,n)}else o.reset()};if(a){var c=a.harf?"_f.png":".png",l=e+n+c,u=RES.getRes(l);u?(t.LoaderManager.instance.removeGroupRef(l),s(u,l)):t.ResManager.getRes(l,s,o,t.LoadPriority.IMMEDIATELY,RES.ResourceItem.TYPE_IMAGE)}else o.reset()};o.isBody&&(o.texture=RES.getRes("preloading_defaultBody_png"),o.x=-o.texture.textureWidth/2,o.y=-o.texture.textureHeight);var c=e+n+".json",l=RES.getRes(c);l?s(l):t.ResManager.getRes(c,s,o,t.LoadPriority.IMMEDIATELY,RES.ResourceItem.TYPE_JSON)}},n.prototype.reset=function(){this.animateData&&(this.texture=null,this.animateData=null),this.curFrame=0},n.prototype.render=function(t){this.curFrame=t;var e=this,n=e.animateData;if(null!=n){var r=e._scale,o=n.getOffset(t),i=n.getTextureByFrame(t);e.texture=i,o&&(e.x=o.x*r+e._offsetX,e.y=o.y*r+e._offsetY,n.halfTexture?(e.width=o.w,e.height=o.h):i&&(e.width=i.textureWidth,e.height=i.textureHeight)),e._effectWidth>0?n.halfTexture?e.scaleX=e._effectWidth/o.w:e.scaleX=e._effectWidth/i.textureWidth:e.scaleX=e.scaleY=r}},Object.defineProperty(n.prototype,"offsetX",{set:function(t){this._offsetX=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"offsetY",{set:function(t){this._offsetY=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scale",{set:function(t){this._scale=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"effectWidth",{get:function(){return this._effectWidth},set:function(t){this._effectWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"firstFrameHeight",{get:function(){var t=this.animateData;return t?t.getTextureByFrame(1).textureHeight:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"totalFrames",{get:function(){var t=this.animateData;return null!=t?t.totalFrames:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"frameRate",{get:function(){var t=this.animateData;return null!=t?t.frameRate:0},enumerable:!0,configurable:!0}),n.prototype.dispos=function(){var e=this;e.curFrame=0,e.parent&&(e.reset(),t.AnimateManager.getInstance().dispos(e.resName),e.parent.removeChild(e))},n}(egret.Bitmap);t.AnimateClip=e,__reflect(e.prototype,"qmr.AnimateClip")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(t){this.d=t}return t.prototype.merge=function(t,e){if(void 0===e&&(e=1),t&&t.hasOwnProperty("d")){var n=t.d;this.key||(this.key=t.key);var r=this.d;r||(r=new Object,this.d=r);for(var o in n){var i=n[o];"number"==typeof i?(r[o]||(r[o]=0),i||(i=0),r[o]=parseFloat(r[o])+i*e):"string"==typeof i?(r[o]||(r[o]=""),i||(i=""),r[o]=i):"boolean"==typeof i?(i||(i=!1),r[o]=i):r[o]=i}}},t.prototype.setRate=function(t){var e=this.d;for(var n in e){var r=e[n];"number"==typeof r&&(r*=t,e[n]=r)}},t}();t.BaseBean=e,__reflect(e.prototype,"qmr.BaseBean")}(qmr||(qmr={}));var qmr;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.isClickHide=!0,t.isNeedMask=!1,t.isNeedAlpha0Mask=!1,t.isPopupEffect=!1,t.isCenter=!1,t.needAdaptStatusBar=!0,t._isShow=!1,t.offsetY=0,t}return __extends(n,e),Object.defineProperty(n.prototype,"groupName",{get:function(){return this._groupName},set:function(t){this._groupName=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"qmrSkinName",{set:function(t){this._qmrSkinName=t},enumerable:!0,configurable:!0}),n.prototype.initComponent=function(){e.prototype.initComponent.call(this),this.resetPos(),this.initUnpackRes(this)},n.prototype.updateGuide=function(){},n.prototype.resetPos=function(){(this.isPopupEffect||this.isCenter)&&(this.anchorOffsetX=this.width>>1,this.anchorOffsetY=(this.height>>1)+this.offsetY,this.x=t.StageUtil.stageWidth>>1,this.y=t.StageUtil.stageHeight>>1)},n.prototype.initListener=function(){var n=this;n.numChildren>0,n.registerNotify(t.StageUtil.STAGE_RESIZE,n.onStageResize,n),e.prototype.initListener.call(this)},n.prototype.getEffective=function(t,e){return this.isShow?!0:this.useTime&&t-this.useTime>=e?!1:!0},n.prototype.onPageBgCloseView=function(){this.hide()},n.prototype.addedToStage=function(t){e.prototype.addedToStage.call(this,t),egret.callLater(this.popupEffect,this)},n.prototype.onStageResize=function(e){var n=this;n.isPopupEffect||n.isCenter||(n.width=t.StageUtil.stageWidth,t.StageUtil.stageHeight>1400&&n.needAdaptStatusBar?(n.height=t.StageUtil.stageHeight-50,n.y=50):(n.height=t.StageUtil.stageHeight,n.y=0)),n.resetPos(),n.layout(),n.maskSprite&&n.maskSprite.onStageResize()},n.prototype.show=function(t){var e=this;e.data=t,e.isSkinLoaded?(e.initListener(),egret.callLater(e.initData,e)):e._qmrSkinName&&(e.skinName=e._qmrSkinName),e.isShow=!0},Object.defineProperty(n.prototype,"isShow",{get:function(){return this._isShow},set:function(t){this._isShow=t},enumerable:!0,configurable:!0}),n.prototype.layout=function(){},n.prototype.getComponentGlobalPoint=function(t){var e=this[t];return e?e.parent?e.parent.localToGlobal(e.x,e.y):e.localToGlobal(e.x,e.y):{x:0,y:0}},n.prototype.hide=function(){this.isPopupEffect?this.closeEffect():t.ModuleManager.hideModule(this)},n.prototype.popupEffect=function(){var e=this;if(e.isPopupEffect){e.alpha=.2,e.scaleX=.2,e.scaleY=.2;var n,r;e.openPos?(n=e.openPos.x,r=e.openPos.y):(n=t.StageUtil.stageWidth>>1,r=t.StageUtil.stageHeight>>1),egret.Tween.get(e).to({scaleX:1,scaleY:1,alpha:1,x:n,y:r},200,egret.Ease.backOut).call(e.doOpenOver,e)}},n.prototype.closeEffect=function(){var e=0,n=0;this._closePos?(e=this._closePos.x,n=this._closePos.y):(e=t.StageUtil.stageWidth>>1,n=t.StageUtil.stageHeight>>1),egret.Tween.get(this).to({scaleX:.3,scaleY:.3,alpha:0,x:e,y:n},180,egret.Ease.cubicOut).call(this.doCloseOver,this)},n.prototype.doOpenOver=function(){},n.prototype.doCloseOver=function(){t.ModuleManager.hideModule(this)},Object.defineProperty(n.prototype,"closePos",{get:function(){return this._closePos},set:function(t){this._closePos=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"openPos",{get:function(){return this._openPos},set:function(t){this._openPos=t},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){e.prototype.dispose.call(this),this.isShow=!1,this.useTime=egret.getTimer(),this.title&&this.updateTitle("",0);var n=this.groupName;void 0!=n&&""!=n&&t.LoaderManager.instance.destoryGroup(n)},n.prototype.closeView=function(){t.ModuleManager.hideModule(this)},n}(t.UIComponent);t.SuperBaseModule=e,__reflect(e.prototype,"qmr.SuperBaseModule")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){this.initListeners()}return e.prototype.initListeners=function(){},e.prototype.dispatch=function(e,n){void 0===n&&(n=null),t.NotifyManager.sendNotification(e,n)},e.prototype.registerNotify=function(e,n,r){t.NotifyManager.registerNotify(e,n,r)},e.prototype.unRegisterNotify=function(e,n,r){t.NotifyManager.unRegisterNotify(e,n,r)},e}();t.BaseNotify=e,__reflect(e.prototype,"qmr.BaseNotify")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){this.ltServerDomain="xyws-sdk.dyhyyx.com",this.canResizeStage=!0,this.initGetOption()}return e.prototype.reqLogin=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return t.WebLoadingManager.setLoadingStatus("验证账号..."),console.log("开始平台登录"),[4,this.login()];case 1:return e.sent(),console.log("平台登录完成"),[2]}})})},e.prototype.reqPay=function(t){},e.prototype.setLoadingProgress=function(t){},e.prototype.logout=function(){},e.prototype.reportRegister=function(){},e.prototype.reportLogin=function(){},e.prototype.reportUpLevel=function(){},e.prototype.reportFightPower=function(t){},e.prototype.shareGame=function(t,e,n){},e.prototype.onShareBack=function(){},e.prototype.share=function(){},e.prototype.addToDesk=function(){},e.prototype.reloadGame=function(e){window.location&&window.location.reload?window.location.reload():t.TipManagerCommon.getInstance().showLanTip("CN_184")},e}();t.BasePlatform=e,__reflect(e.prototype,"qmr.BasePlatform")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){this.initListeners()}return e.prototype.initListeners=function(){},e.prototype.sendCmd=function(e,n,r){void 0===r&&(r=!1),t.Rpc.getInstance().sendCmd(e,n,r)},e.prototype.dispatch=function(e,n){void 0===n&&(n=null),t.NotifyManager.sendNotification(e,n)},e.prototype.registerNotify=function(e,n,r){t.NotifyManager.registerNotify(e,n,r)},e.prototype.unRegisterNotify=function(e,n,r){t.NotifyManager.unRegisterNotify(e,n,r)},e.prototype.rpc=function(e,n,r,o,i,a,s,c){void 0===a&&(a=null),void 0===s&&(s=null),void 0===c&&(c=!1),t.Rpc.getInstance().rpcCMD(e,n,r,o,i,a,s,c)},e.prototype.addSocketListener=function(e,n,r,o){void 0===o&&(o=!1),t.Rpc.getInstance().addSocketListener(e,n,r,o)},e.prototype.removeSocketListener=function(e,n,r){t.Rpc.getInstance().removeSocketListener(e,n,r)},e.prototype.loadAndPlayEffect=function(e,n,r){void 0===n&&(n=1),void 0===r&&(r=!1),t.SoundManager.getInstance().loadAndPlayEffect(e,n,r)},e.prototype.checIsLock=function(t){if(!this._reqDic)return!1;var e=this._reqDic.has(t)?this._reqDic.get(t):0,n=egret.getTimer();return e>n},e.prototype.setReqLock=function(e,n){void 0===n&&(n=15e3),this._reqDic||(this._reqDic=new t.Dictionary);var r=egret.getTimer(),o=r+n;this._reqDic.set(e,o)},e.prototype.resetLock=function(){this._reqDic&&this._reqDic.clear()},e.prototype.removeAllListener=function(){this.resetLock()},e}();t.BaseController=e,__reflect(e.prototype,"qmr.BaseController")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){this._values=[],this._keys=[]}return Object.defineProperty(t.prototype,"values",{get:function(){return this._values},set:function(t){this._values=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keys",{get:function(){return this._keys},set:function(t){this._keys=t},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){var n=this.indexOf(t);return n>=0?void(this._values[n]=e):(this._keys.push(t),void this._values.push(e))},t.prototype.setConf=function(t,e){this._keys.push(t),this._values.push(e)},t.prototype.indexOf=function(t){var e=this._keys.indexOf(t);return e>=0?e:(t=t instanceof String?Number(t):t instanceof Number?t.toString():t,this._keys.indexOf(t))},t.prototype.get=function(t){var e=this.indexOf(t);return 0>e?null:this._values[e]},t.prototype.has=function(t){var e=this.indexOf(t);return e>=0},Object.defineProperty(t.prototype,"length",{get:function(){return this.keys.length},enumerable:!0,configurable:!0}),t.prototype.remove=function(t){var e=this.indexOf(t);return e>=0?(this._keys.splice(e,1),this._values.splice(e,1),!0):!1},t.prototype.clear=function(){this._values.length=0,this._keys.length=0},t}();t.Dictionary=e,__reflect(e.prototype,"qmr.Dictionary")}(qmr||(qmr={}));var qmr;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="GameLoadingProgressBarSkin",e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.showProgressRate=function(t,e){void 0===e&&(e=!1);var n=t;0>=n&&(n=0),n>=1&&(n=1);var r=528*n;egret.Tween.removeTweens(this.imgProgress),e?egret.Tween.get(this.imgProgress).to({width:r},300):this.imgProgress.width=r,this.imgCloud.x=r},e.prototype.setLoadingTip=function(t){this.labHint.text=t},e.prototype.dispose=function(){egret.Tween.removeTweens(this.imgProgress)},e}(eui.Component);t.GameLoadingProgressBar=e,__reflect(e.prototype,"qmr.GameLoadingProgressBar")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){this.maxAliveTime=1e4,this.animaDic={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.parseSpriteSheet=function(e,n,r,o,i,a){void 0===i&&(i=-1),void 0===a&&(a=!0);var s,c=new egret.SpriteSheet(o);for(var l in r.mc)if(null!=l&&0!=l.length){s=r.mc[l];break}if(s){var u=this.animaDic[e];u||(u={},this.animaDic[e]=u),u.url=n,u.sheet=c;var p=s.labels,f=r.harf;if(p&&p.length>1)for(var g=0,h=p;g<h.length;g++){var d=h[g],m=new t.AnimateData(r.res,c,a,f);m.parseClipByStartAndEnd(s,parseInt(d.frame),parseInt(d.end)),u[parseInt(d.name)]=m}else{var m=new t.AnimateData(r.res,c,a,f);m.parseClip(s),u.data=m}}},e.prototype.getAnimalData=function(t,e){var n=this.animaDic[t];if(!n)return null;var r=n.count;return r?r+=1:r=1,n.count=r,n.useTime=egret.getTimer(),e>0&&-1==t.indexOf("death")?n[e]:n.data},e.prototype.dispos=function(t){if("168_idle"!=t){var e=this.animaDic[t];if(e){var n=e.count;n?n-=1:n=0,0>=n&&(n=0),e.count=n}}},e.prototype.clear=function(e){var n=this.animaDic,r=this.maxAliveTime;for(var o in n){var i=n[o];if(0==i.count&&i.useTime&&e-i.useTime>r){i.sheet&&i.sheet.dispose();var a=RES.destroyRes(i.url);t.LogUtil.warn("AnimationManager.destroy url="+i.url+"  "+a),n[o]=null,delete n[o]}}},e}();t.AnimateManager=e,__reflect(e.prototype,"qmr.AnimateManager")}(qmr||(qmr={}));var qmr;!function(t){var e=function(t){function e(e,n){void 0===e&&(e=null),void 0===n&&(n=null);var r=t.call(this,e,n)||this;return r._wingFrame=0,r._wingFrameIndex=0,r}return __extends(e,t),e.prototype.render=function(e){this._wingFrame!=e&&(this._wingFrame=e,this._wingFrameIndex++),e=1+this._wingFrameIndex%this.totalFrames,t.prototype.render.call(this,e)},e.prototype.reset=function(){t.prototype.reset.call(this),this._wingFrame=0,this._wingFrameIndex=0},e}(t.AnimateClip);t.AnimateWing=e,__reflect(e.prototype,"qmr.AnimateWing")}(qmr||(qmr={}));var qmr;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n.currentFrame=1,n.totalFrame=0,n.isStopped=!0,n.passedTime=0,n.lastTime=0,n.frameRate=30,n.eventDic={},n._timeScale=1,n.mainClip=new t.AnimateClip(n.onLoaded,n),n.addChild(n.mainClip),n}return __extends(n,e),n.prototype.load=function(t,e,n,r,o){void 0===o&&(o=1),this.playeTimes=1,this.loopCallBack=n,this.thisObject=r,this.mainClip.load(t,e)},n.prototype.onLoaded=function(){this.totalFrame=this.mainClip.totalFrames,this.frameRate=this.mainClip.frameRate,this.currentFrame=1,this.render(),this.setIsStopped(!1),1==this.totalFrame&&this.gotoAndStop(1)},n.prototype.registerFrameEvent=function(t,e,n){this.eventDic[t]={callBack:e,thisObject:n}},n.prototype.unRegisterFrameEvent=function(t){this.eventDic[t]&&(this.eventDic[t]=null,delete this.eventDic[t])},n.prototype.advanceTime=function(t){var e=this,n=t-e.lastTime;e.lastTime=t;var r=e.frameIntervalTime,o=e.passedTime+n;e.passedTime=o%r;var i=o/r;if(1>i)return!1;for(e.render();i>=1;)i--,e.currentFrame++,e.checkFrameEvent();return!1},n.prototype.checkFrameEvent=function(){var t=this.eventDic[this.currentFrame];t&&t.callBack&&t.callBack.call(t.thisObject)},n.prototype.clearCallBack=function(){this.loopCallBack=null},n.prototype.render=function(){var t=this;return t.totalFrame>0&&t.currentFrame>t.totalFrame&&(t.loopCallBack&&t.loopCallBack.call(t.thisObject),t.currentFrame=1,1==t.playeTimes)?void t.setIsStopped(!0):void t.mainClip.render(t.currentFrame)},Object.defineProperty(n.prototype,"frameRate",{set:function(t){t>60&&(t=60),this._frameRate=t,this.frameIntervalTime=1e3/(t*this._timeScale)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"timeScale",{set:function(t){isNaN(this.frameRate)||(this._timeScale=t,this.frameIntervalTime=1e3/(this._frameRate*t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"totalFrames",{get:function(){return this.totalFrame},enumerable:!0,configurable:!0}),n.prototype.gotoAndStop=function(t){this.mainClip.render(t),this.setIsStopped(!0)},n.prototype.setIsStopped=function(t){this.isStopped!=t&&(this.isStopped=t,t?egret.stopTick(this.advanceTime,this):(this.lastTime=egret.getTimer(),egret.startTick(this.advanceTime,this)))},n.prototype.clear=function(){this.mainClip&&this.mainClip.reset()},n.prototype.dispos=function(){this.mainClip&&this.mainClip.dispos(),this.setIsStopped(!0);for(var t in this.eventDic)this.eventDic[t]=null,delete this.eventDic[t];this.parent&&this.parent.removeChild(this)},n}(egret.DisplayObjectContainer);t.MovieClip=e,__reflect(e.prototype,"qmr.MovieClip")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.BODY=0,t.WEAPON=1,t.WING=2,t.HORSE=4,t.HORSE_UP=5,t.SHIELD=6,t.DEFAULT=7,t}();t.ActorPart=e,__reflect(e.prototype,"qmr.ActorPart")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){var e={};e[t.ActorPart.WEAPON]=t.SystemPath.weaponPath,e[t.ActorPart.WING]=t.SystemPath.wingPath,e[t.ActorPart.HORSE]=t.SystemPath.horsePath,e[t.ActorPart.HORSE_UP]=t.SystemPath.horsePath,e[t.ActorPart.DEFAULT]=t.SystemPath.defaultPath,this.partDic=e}return e.getInstance=function(){return null==e._instance&&(e._instance=new e),e._instance},e}();t.ActorPartResourceDic=e,__reflect(e.prototype,"qmr.ActorPartResourceDic")}(qmr||(qmr={}));var qmr;!function(t){var e=function(e){function n(n,r,o,i){void 0===i&&(i=t.Status.IDLE);var a=e.call(this)||this,s=a;return s.resourcePath=n,s.loadCallBack=r,s.loadThisObject=o,s.currentFrame=1,s.totalFrame=0,s.isStopped=!0,s.isDirLoaded=!1,s.isNoRendering=!1,s.passedTime=0,s.lastTime=0,s._timeScale=1,s.act=i,s.frameRate=30,s.eventDic={},s.actDic={},s.partDic={},s.partIdDic={},s.addEventListener(egret.Event.ADDED_TO_STAGE,s.addToStage,s),s.addEventListener(egret.Event.REMOVED_FROM_STAGE,s.removeToStage,s),a}return __extends(n,e),n.prototype.addToStage=function(){this.setIsStopped(!1),this.render()},n.prototype.removeToStage=function(){this.setIsStopped(!0)},Object.defineProperty(n.prototype,"isNoRendering",{get:function(){return this._isNoRendering},set:function(t){this._isNoRendering=t},enumerable:!0,configurable:!0}),n.prototype.setIsDirLoad=function(t){this.isDirLoaded=t;var e=this.partDic;for(var n in e){var r=e[n];r.setIsDirLoad(t)}},n.prototype.addPartAt=function(e,n,r,o,i,a,s){if(void 0===r&&(r=-1),void 0===o&&(o=1),void 0===i&&(i=!1),void 0===a&&(a=null),void 0===s&&(s=!0),n){var c=this;if(c.addPartTo(e,n,r,o,i,a),e==t.ActorPart.BODY&&s){var l=c.partDic[t.ActorPart.DEFAULT];l||(c.addPartTo(t.ActorPart.DEFAULT,9999,r,o,i,a),l=c.partDic[t.ActorPart.DEFAULT],l.offsetY=-85)}}},n.prototype.addPartTo=function(e,n,r,o,i,a){void 0===r&&(r=-1),void 0===o&&(o=1),void 0===i&&(i=!1),void 0===a&&(a=null);var s=this,c=s.act,l=s.partDic[e];if(s.partIdDic[e]=n,s.dir=o,l){-1!=r?s.addChildAt(l,r):s.addChild(l),l.setIsDirLoad(i),l.containsAct(c)||(c=e==t.ActorPart.HORSE?t.Status.IDLE_RIDE:t.Status.IDLE);var u=t.ActorPartResourceDic.getInstance().partDic[e];l.load(u?u:s.resourcePath,n+"_"+c,t.DirUtil.getDir(o))}else{l=e==t.ActorPart.BODY?new t.AnimateClip(s.onLoaded,s):e==t.ActorPart.DEFAULT?new t.AnimateClip(s.onLoadedDefault,s):e==t.ActorPart.WING?new t.AnimateWing(s.onLoadedOther,s):new t.AnimateClip(s.onLoadedOther,s),-1!=r?s.addChildAt(l,r):s.addChild(l),l.containsAct(c)||(c=e==t.ActorPart.HORSE?t.Status.IDLE_RIDE:t.Status.IDLE),s.partDic[e]=l;var u=t.ActorPartResourceDic.getInstance().partDic[e];l.load(u?u:s.resourcePath,n+"_"+c,t.DirUtil.getDir(o))}},n.prototype.setPartVisible=function(t,e){var n=this.partDic[t];n.visible=e},n.prototype.removePart=function(t){var e=this.partDic[t];e&&(e.dispos(),delete this.partDic[t],delete this.partIdDic[t])},n.prototype.getPart=function(e){return void 0===e&&(e=t.ActorPart.BODY),this.partDic[e]},n.prototype.setPartActs=function(t,e){var n=this.partDic;for(var r in n)if(parseInt(r)==t){var o=n[t];o&&o.setActs(e)}e.indexOf(",")>-1?this.act=e.split(",")[0]:this.act=e},n.prototype.gotoAndPlay=function(e,n,r,o,i){void 0===r&&(r=null),void 0===o&&(o=null),void 0===i&&(i=!1);var a=this;if(a.loopCallBack=r,a.loopThisObject=o,i||a.act!=e){a.actDic[e]=!1,a.act=e,a.dir=n,a.currentFrame=1;var s=Math.abs(a.scaleX);5>=n?a.scaleX=s:a.scaleX=-s,a.act==t.Status.DEAD&&(n=-1);var c=a.partDic,l=a.partIdDic;a.setIsStopped(!0);for(var u in c){var p=c[u];if(p){var f=a.act;p.containsAct(f)||(f=parseInt(u)==t.ActorPart.HORSE?t.Status.IDLE_RIDE:t.Status.IDLE);var g=t.ActorPartResourceDic.getInstance().partDic[u],h=g?g:a.resourcePath;p.load(h,l[u]+"_"+f,t.DirUtil.getDir(n))}}}},n.prototype.clearCallBack=function(){this.loopCallBack=null},n.prototype.changeDir=function(e){var n=this;if(n.dir!=e){n.dir=e;var r=Math.abs(n.scaleX);5>=e?n.scaleX=r:n.scaleX=-r;var o=n.partDic,i=n.partIdDic;for(var a in o){var s=o[a];if(s){var c=n.act;s.containsAct(c)||(c=parseInt(a)==t.ActorPart.HORSE?t.Status.IDLE_RIDE:t.Status.IDLE);var l=t.ActorPartResourceDic.getInstance().partDic[a],u=l?l:n.resourcePath;s.load(u+i[a]+"/",i[a]+"_"+c,t.DirUtil.getDir(e))}}}},n.prototype.gotoAndStop=function(t){this.currentFrame=t,this.render(),this.setIsStopped(!0)},n.prototype.onLoadedDefault=function(e,n){var r=this,o=r.partDic[t.ActorPart.DEFAULT];o&&(r.totalFrame=o.totalFrames,r.frameRate=o.frameRate,r.setIsStopped(!1))},n.prototype.onLoadedOther=function(e){var n=this,r=n.partDic[t.ActorPart.DEFAULT];r&&(n.removePart(t.ActorPart.DEFAULT),n.totalFrame=1),e||n.changeDir(n.dir)},n.prototype.onLoaded=function(e,n){var r=this;if(r.removePart(t.ActorPart.DEFAULT),-1!=n.indexOf(r.act)){var o=r.partDic[t.ActorPart.BODY];o?(r.totalFrame=o.totalFrames,r.frameRate=o.frameRate):r.totalFrame=0,r.totalFrame>0?(r.actDic[r.act]=!0,1==r.totalFrame?r.gotoAndStop(1):r.setIsStopped(!1),r.loadCallBack&&r.loadCallBack.call(r.loadThisObject)):r.gotoAndPlay(r.act,r.dir)}},Object.defineProperty(n.prototype,"firstBodyFrameHeight",{get:function(){var e=this.partDic[t.ActorPart.BODY];return e?e.firstFrameHeight:0},enumerable:!0,configurable:!0}),n.prototype.registerFrameEvent=function(t,e,n){this.eventDic[t]={callBack:e,thisObject:n}},n.prototype.unRegisterFrameEvent=function(t){var e=this.eventDic;e[t]&&(e[t]=null,delete e[t])},n.prototype.clearFrameEvent=function(){var t=this.eventDic;for(var e in t)t[e]=null,delete t[e]},n.prototype.advanceTime=function(t){var e=this;if(e.isNoRendering)return e.gotoAndStop(1),!1;var n=t-e.lastTime;e.lastTime=t;var r=e.frameIntervalTime,o=e.passedTime+n;e.passedTime=o%r;var i=o/r;if(1>i)return!1;for(e.render();i>=1;)i--,e.currentFrame++,e.actDic[e.act]&&e.checkFrameEvent();return!1},n.prototype.checkFrameEvent=function(){var t=this.eventDic[this.currentFrame];t&&t.callBack&&t.callBack.call(t.thisObject)},n.prototype.render=function(){var t=this;
if(t.totalFrame>0&&(t.currentFrame>t.totalFrame&&(t.currentFrame=1,t.loopCallBack&&t.loopCallBack.call(t.loopThisObject)),1==t.totalFrame||t.stage)){var e=t.partDic,n=t.currentFrame;for(var r in e){var o=e[r];o&&o.render(n)}}},Object.defineProperty(n.prototype,"frameRate",{set:function(t){t>60&&(t=60),this._frameRate=t,this.frameIntervalTime=1e3/(t*this._timeScale)},enumerable:!0,configurable:!0}),n.prototype.getTotalFrame=function(){return this.totalFrame},Object.defineProperty(n.prototype,"timeScale",{get:function(){return this._timeScale},set:function(t){0>=t&&(t=1),this._timeScale=t,this.frameIntervalTime=1e3/(this._frameRate*t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"act",{get:function(){return this._act},set:function(t){this._act=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"resourcePath",{get:function(){return this._resourcePath},set:function(t){this._resourcePath=t},enumerable:!0,configurable:!0}),n.prototype.setIsStopped=function(t){var e=this;e.isStopped!=t&&(e.isStopped=t,t?egret.stopTick(e.advanceTime,e):1==e.totalFrame||e.isNoRendering?e.gotoAndStop(1):(e.lastTime=egret.getTimer(),egret.startTick(e.advanceTime,e)))},n.prototype.getDir=function(){return this.dir},n.prototype.clear=function(){this.setIsStopped(!0),this.clearFrameEvent(),this.parent&&this.parent.removeChild(this)},n.prototype.dispos=function(t){void 0===t&&(t=!0);var e=this;e.setIsStopped(!0),e.clearFrameEvent(),e.removeEventListener(egret.Event.ADDED_TO_STAGE,e.addToStage,e),e.removeEventListener(egret.Event.REMOVED_FROM_STAGE,e.removeToStage,e);for(var n in e.partDic)e.removePart(n);e.parent&&t&&e.parent.removeChild(e)},n}(egret.DisplayObjectContainer);t.BaseActor=e,__reflect(e.prototype,"qmr.BaseActor")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.IDLE="idle",t.ATTACK="attack",t.ATTACK2="attack2",t.MOVE="move",t.FLY="move",t.DEAD="death",t.SKILL="skill",t.SKILL2="skill2",t.IDLE_RIDE="idle_ride",t.MOVE_RIDE="move_ride",t.ATTACK_RIDE="attack_ride",t.JUMP="fly",t.JUMP_ATTACK="jump_attack",t.STAND="stand",t.PICK="pick",t.UI_SHOW="ui_show",t.UI_SHOW1="ui_show_1",t.UI_IDLE="ui_idle",t}();t.Status=e,__reflect(e.prototype,"qmr.Status")}(qmr||(qmr={}));var qmr;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.iscompleted=!1,t.isSeted=!1,t.skinName="CommonTipSkin",t.touchEnabled=t.touchChildren=!1,t}return __extends(n,e),n.prototype.initComponent=function(){e.prototype.initComponent.call(this),this.iscompleted=!0},n.prototype.initData=function(){e.prototype.initData.call(this),this.setTip()},n.prototype.onStageResize=function(){e.prototype.onStageResize.call(this),this.x=(t.StageUtil.stageWidth-640)/2},n.prototype.showTip=function(t){this.data=t,this.iscompleted&&this.setTip()},n.prototype.setTip=function(){this.data&&(this.isSeted||(this.x=(t.StageUtil.stageWidth-640)/2,this.isSeted=!0,this.alpha=1,this.data.color?(this.lbl_tipMsg.text=this.data.mess,this.lbl_tipMsg.textColor=this.data.color):this.lbl_tipMsg.textFlow=t.HtmlUtil.getHtmlString(this.data.mess),this.data.itemcfg&&t.ImageUtil.setItemIcon(this.img_icon,this.data.itemcfg.icon,this.data.itemcfg.page),this.y=t.StageUtil.stageHeight/2-this.height/2+this.data.yPos,this.common_g.width=this.lbl_tipMsg.width+200,egret.Tween.get(this).to({y:t.StageUtil.stageHeight/3+50+this.data.yPos},1500).to({y:t.StageUtil.stageHeight/3+this.data.yPos,alpha:0},800).call(this.dispose,this)))},n.prototype.dispose=function(){this.data=null,this.isSeted=!1,this.lbl_tipMsg.text="",this.img_icon.source=null,egret.Tween.removeTweens(this),e.prototype.dispose.call(this),t.TipManagerCommon.getInstance().recycleCommonTip(this)},n}(t.UIComponent);t.CommonTip=e,__reflect(e.prototype,"qmr.CommonTip")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){this.LOGIN_KEY="Dragon2020WOMenYIQiFaDaCAI#WOCAO@^^%(*88888888abZ"}return Object.defineProperty(t,"isSysIos",{get:function(){return"IOS"==egret.Capabilities.os.toUpperCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isCN",{get:function(){return"CN"==t.LAN_TYPE},enumerable:!0,configurable:!0}),t.bIsShowSlowLog=!1,t.loginInitFinish=!1,t.isDebugF=!1,t.loginType=0,t.account="",t.pwd="",t.telephone="",t.verifyCode="",t.loginServer="129.226.177.253",t.loginPort=8003,t.sparam="0",t.sid="1",t.clientIp="127.0.0.1",t.logintime=0,t.LAN_TYPE="CN",t}();t.GlobalConfig=e,__reflect(e.prototype,"qmr.GlobalConfig")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.CodeCfg=!0,t.Music=!0,t.ClientCn=!0,t}();t.BaseConfigKeys=e,__reflect(e.prototype,"qmr.BaseConfigKeys")}(qmr||(qmr={}));var qmr;!function(t){var e=function(t){function e(e){var n=t.call(this,e)||this;return n.key="id",n}return __extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.d.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"msg",{get:function(){return this.d.msg},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.d.type},enumerable:!0,configurable:!0}),e}(t.BaseBean);t.CodeCfgCfg=e,__reflect(e.prototype,"qmr.CodeCfgCfg");var n=function(t){function e(e){var n=t.call(this,e)||this;return n.key="soundType",n}return __extends(e,t),Object.defineProperty(e.prototype,"soundType",{get:function(){return this.d.soundType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"soundName",{get:function(){return this.d.soundName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPlaySameTime",{get:function(){return this.d.isPlaySameTime},enumerable:!0,configurable:!0}),e}(t.BaseBean);t.MusicCfg=n,__reflect(n.prototype,"qmr.MusicCfg");var r=function(t){function e(e){var n=t.call(this,e)||this;return n.key="id",n}return __extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.d.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.d.value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"en_value",{get:function(){return this.d.en_value},enumerable:!0,configurable:!0}),e}(t.BaseBean);t.ClientCnCfg=r,__reflect(r.prototype,"qmr.ClientCnCfg")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.CODECFG="CodeCfg",t.MUSIC="Music",t.CLIENTCN="ClientCn",t}();t.ConfigEnumBase=e,__reflect(e.prototype,"qmr.ConfigEnumBase")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return e.getConf=function(t,e){var n,r=this.getBean(t);return r?n=r.get(e):null},e.getBean=function(e){var n=this.cfgDic.get(e);return n||(n=this.parseConfigFromZip(e),this.cfgDic.set(e,n),t.LogUtil.log("ConfigManagerBase.parseConfigFromZip:",e)),n},e.parseConfigFromZip=function(e){var n,r=this,o=new t.Dictionary,i=e.charAt(0).toLocaleUpperCase()+e.slice(1,e.length)+"Cfg",a=t[i];n=e==t.ConfigEnumBase.MUSIC||e==t.ConfigEnumBase.CODECFG?r.getZip(r.BASE_CONFIG_NAME):r.getZip(r.WHOLE_CONFIG_NAME),n||console.error("配置读取失败");var s=n.file(e+".json");s||t.LogUtil.warn("从zip中解析一张表 = "+e+" 异常，请查看配置是否提交？？");var c=JSON.parse(s.asText());return a&&c.forEach(function(e){var n=new a(e);if(n.key){var i=r.getkey(n,e);o.setConf(i,n)}else t.LogUtil.warn("获取配置表的唯一key 错误了。。。"+n)}),o},e.getZip=function(e){this.zipDic||(this.zipDic=new t.Dictionary);var n=this.zipDic.get(e);if(!n){var r=RES.getRes(e);r&&(n=new JSZip(r),this.zipDic.set(e,n))}return n},e.getkey=function(t,e){if(t.key){var n=t.key.split("_"),r="",o=n.length;return 1==o?r=e[t.key]:n.forEach(function(t,n){r+=n!=o-1?e[t]+"_":e[t]}),r}},e.cfgDic=new t.Dictionary,e.WHOLE_CONFIG_NAME="config_bin",e.BASE_CONFIG_NAME="configbase_bin",e}();t.ConfigManager=e,__reflect(e.prototype,"qmr.ConfigManager")}(qmr||(qmr={}));var qmr;!function(t){var e;!function(t){t[t.Type_1=1]="Type_1",t[t.Type_2=2]="Type_2"}(e=t.BtnSkinType||(t.BtnSkinType={}));var n;!function(t){t[t.SYSTEM=1]="SYSTEM",t[t.WORLD=2]="WORLD",t[t.TEAM=3]="TEAM",t[t.SELF=4]="SELF",t[t.UNION=5]="UNION",t[t.CROSS=6]="CROSS"}(n=t.CHAT_CHANNELID||(t.CHAT_CHANNELID={}))}(qmr||(qmr={}));var qmr;!function(t){var e;!function(t){t[t.BG_MUSIC=1]="BG_MUSIC",t[t.EFFECT_MUSIC=2]="EFFECT_MUSIC"}(e=t.MusicType||(t.MusicType={}));var n;!function(t){t[t.ROLE_MALE=101]="ROLE_MALE",t[t.ROLE_FEMALE=102]="ROLE_FEMALE"}(n=t.WarriorRole||(t.WarriorRole={}));var r;!function(t){t[t.COLOR_G=9067563]="COLOR_G",t[t.COLOR_GREEN=632328]="COLOR_GREEN",t[t.COLOR_BLUE=2197196]="COLOR_BLUE",t[t.COLOR_VIOLET=16722152]="COLOR_VIOLET",t[t.COLOR_CADMIUM=15095046]="COLOR_CADMIUM",t[t.COLOR_RED=14489856]="COLOR_RED",t[t.COLOR_DIAMOND=4758466]="COLOR_DIAMOND"}(r=t.ColorQualityConst||(t.ColorQualityConst={}));var o;!function(t){t[t.TIEM=0]="TIEM",t[t.HERO=1]="HERO",t[t.EQUIP=2]="EQUIP"}(o=t.BagType||(t.BagType={}));var i;!function(t){t[t.small=0]="small",t[t.mid=1]="mid",t[t.big=2]="big",t[t.UI=3]="UI"}(i=t.ActorSizeType||(t.ActorSizeType={}))}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t}();t.NotifyConstBase=e,__reflect(e.prototype,"qmr.NotifyConstBase")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.S_ERROR_CODE="S_ERROR_CODE",t.S_LOGIN_REGISTER="S_LOGIN_REGISTER",t.S_USER_LOGIN="S_USER_LOGIN",t.S_USER_LOGIN_REPEAT="S_USER_LOGIN_REPEAT",t.S_LOGIN_OFFLINE_HANGUP_PUSH="S_LOGIN_OFFLINE_HANGUP_PUSH",t.S_USER_LOGOUT="S_USER_LOGOUT",t.TAB_VIEW_ADDPAGE="TAB_VIEW_ADDPAGE",t.TAB_VIEW_REMOVEPAGE="TAB_VIEW_REMOVEPAGE",t.TAB_VIEW_CHANGE_TAB="TAB_VIEW_CHANGE_TAB",t.UPDATE_OPEN_TITLE="UPDATE_OPEN_TITLE",t.UPDATE_MODULE_TITLE="UPDATE_MODULE_TITLE",t.OPEN_PANEL_LAYER="OPEN_PANEL_LAYER",t.CLOSE_PANEL_LAYER="CLOSE_PANEL_LAYER",t.OPEN_PANEL_VIEW="OPEN_PANEL_VIEW",t.CLOSE_PANEL_VIEW="CLOSE_PANEL_VIEW",t.SCNY_ONE_SERVER_TIME="SCNY_ONE_SERVER_TIME",t.CROSS_DAY="CROSS_DAY",t.CHANGE_MODEL_VIEW="SHOW_OR_HIDE_GUIDE",t.TO_HIDE_VIP_VIEW="TO_HIDE_VIP_VIEW",t.TO_REQUEST_SHARE_REWARD="TO_REQUEST_SHARE_REWARD",t}();t.NotifyConstLogin=e,__reflect(e.prototype,"qmr.NotifyConstLogin")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(t,e,n,r){this._id=0,this.setTo(t,e,n,r)}return t.prototype.setTo=function(e,n,r,o){return this._id=t._gid++,this.caller=e,this.method=n,this.args=r,this.once=o,this},t.prototype.run=function(){if(null==this.method)return null;var t=this._id,e=this.method.apply(this.caller,this.args);return this._id===t&&this.once&&this.recover(),e},t.prototype.runWith=function(t){if(null==this.method)return null;var e,n=this._id;return e=this.args?this.method.apply(this.caller,this.args.concat(t)):this.method.apply(this.caller,t),this._id===n&&this.once&&this.recover(),e},t.prototype.recover=function(){this._id>0&&(this._id=0,t._pool.push(this.clear()))},t.create=function(e,n,r,o){return void 0===r&&(r=null),void 0===o&&(o=!0),this._pool.length?this._pool.pop().setTo(e,n,r,o):new t(e,n,r,o)},t.prototype.clear=function(){return this.caller=null,this.method=null,this.args=null,this},t._pool=[],t._gid=1,t}();t.Handler=e,__reflect(e.prototype,"qmr.Handler")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.sendPost=function(t,e,n,r){var o="",i=0;for(var a in e)o+=0==i?a+"="+e[a]:"&"+a+"="+e[a],i++;var s=new egret.HttpRequest;s.responseType=egret.HttpResponseType.TEXT,s.open(t,egret.HttpMethod.POST),s.send(o),s.addEventListener(egret.Event.COMPLETE,function(t){n&&n.call(s.response)},this)},t.sendGet=function(t,e,n){var r=new egret.HttpRequest;r.timeout=1e4,r.responseType=egret.HttpResponseType.TEXT,r.open(t,egret.HttpMethod.GET),r.send(null),r.addEventListener(egret.Event.COMPLETE,function(t){e&&e.call(n,r.response)},this),r.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){},this)},t}();t.HttpRequest=e,__reflect(e.prototype,"qmr.HttpRequest")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.MAP_LAYER="mapLayer",t.FIGTH_UI="figthUI",t.TOOLBAR="toolbar",t.BASE_UI="baseUI",t.UI_EFFECT="uiEffect",t.ALERT="alert",t.TIP="tip",t.LOADING="loading",t.MASK_UI="maskUI",t.TOP="top",t}();t.LayerConst=e,__reflect(e.prototype,"qmr.LayerConst")}(qmr||(qmr={}));var qmr;!function(t){var e=egret.DisplayObjectContainer,n=function(){function n(){this.layerList=new Array,this.layerDic=new t.Dictionary}return Object.defineProperty(n,"instance",{get:function(){return null==this._instance&&(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.prototype.setup=function(e){this._parent=e,this.layerIndex=this._parent.numChildren,this.addLayer(t.LayerConst.MAP_LAYER,!0),this.addLayer(t.LayerConst.FIGTH_UI,!0),this.addLayer(t.LayerConst.TOOLBAR,!0),this.addLayer(t.LayerConst.BASE_UI,!0),this.addLayer(t.LayerConst.UI_EFFECT,!0),this.addLayer(t.LayerConst.ALERT,!0),this.addLayer(t.LayerConst.TIP,!0),this.addLayer(t.LayerConst.LOADING,!0),this.addLayer(t.LayerConst.MASK_UI,!0),this.addLayer(t.LayerConst.TOP,!0)},n.prototype.addLayer=function(t,n){var r,o=this._parent.getChildByName(t);o||(r=new e,r.touchEnabled=r.touchChildren=n,r.name=t,this.layerList.push(r),this._parent.addChild(r),this.layerDic.set(t,r))},n.prototype.getLayer=function(t){return t?this.layerDic.get(t):null},n.prototype.addChild=function(t,e){var n=this.getLayer(e);return n&&n.addChild(t),t},n.prototype.addChildAt=function(t,e,n){void 0===n&&(n=0);var r=this.getLayer(e);return r&&r.addChildAt(t,0),t},n.prototype.removeChild=function(t){return t?(t.parent&&t.parent.removeChild(t),t):t},n.prototype.setCenter=function(e){e&&(e.x=Math.floor((t.StageUtil.stageWidth-e.width)/2),e.y=Math.floor((t.StageUtil.stageHeight-e.height)/2))},Object.defineProperty(n.prototype,"layersVisible",{set:function(t){for(var e=0,n=this.layerList;e<n.length;e++){var r=n[e];if(r.visible==t)break;r.visible=t}},enumerable:!0,configurable:!0}),n.prototype.addDisplay=function(t,e,n){var r=this.getLayer(e);n?r.addChildAt(t,999):r.addChild(t)},n}();t.LayerManager=n,__reflect(n.prototype,"qmr.LayerManager")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return e.loadGroup=function(t,n,r,o,i){void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=0),void 0===i&&(i=null),e.addLoader(t,n,r,o,null,!0,i)},e.getRes=function(t,n,r,o,i){function a(e){n&&n.call(r,e,t)}if(void 0===o&&(o=0),void 0===i&&(i=null),t){if(RES.hasRes(t)){var s=RES.getRes(t);if(s)return void a(s)}e.addLoader(t,n,r,o,i)}},e.addLoader=function(o,i,a,s,c,l,u){void 0===s&&(s=0),void 0===c&&(c=null),void 0===l&&(l=!1),void 0===u&&(u=null);var p=r.get();p.init(e.loaderCompleted,o,i,a,c,s,l,u);var f=e._sameResInfoDic;f||(f=new t.Dictionary,e._sameResInfoDic=f);var g=f.get(o);if(g)g.push(p),e.checkSameLoaderPriority(o,s);else if(g=[],f.set(o,g),s>=n.IMMEDIATELY)e.startLoader(p);else{var h=e._loaderQueue;h||(h=[],e._loaderQueue=h),h.push(p),e.checkToLoadNext()}},e.checkSameLoaderPriority=function(t,r){var o=e._loaderQueue;if(o)for(var i=o.length,a=0;i>a;a++){var s=o[a];if(s.source==t){s.priority<r&&(s.priority=r,r==n.IMMEDIATELY?(o.splice(a,1),e.startLoader(s)):e.checkToLoadNext());break}}},e.checkToLoadNext=function(){var t=e._loaderQueue;if(t){var r=t.length;if(r>0){var o=t[r-1],i=!1;o.priority>=n.HIGH?e._loadingCount<e.HIGH_PRIORITY_MAX_COUNT&&(i=!0):o.priority<=n.LOW&&e._loadingCount<e.LOW_PRIORITY_MAX_COUNT&&(i=!0),i&&(o=t.pop(),e.startLoader(o))}}},e.startLoader=function(t){e._loadingCount++,t.load()},e.loaderCompleted=function(n,o,i){try{if(o){e.callbackLoader(n,i);var a=e._loaderQueue;if(a&&a.length>0)for(var s=a.length,c=s-1;c>=0;c--){var l=a[c];if(RES.hasRes(l.source)){var u=RES.getRes(l.source);u&&(e.callbackLoader(l,u),a.splice(c,1),r.recycle(l))}}}var p=e._sameResInfoDic.get(n.source),f=0;if(p&&(e._sameResInfoDic.remove(n.source),o)){f=p.length;for(var c=0;f>c;c++){var g=p[c];e.startLoader(g)}}r.recycle(n)}catch(h){t.LogUtil.log("ResManager.loaderCompleted error"+h)}finally{e._loadingCount--,e.checkToLoadNext()}},e.callbackLoader=function(t,e){t.compFunc&&(e?t.compFunc.call(t.thisObject,e,t.source):t.compFunc.call(t.thisObject))},e.LOW_PRIORITY_MAX_COUNT=1,e.HIGH_PRIORITY_MAX_COUNT=4,e._loadingCount=0,e}();t.ResManager=e,__reflect(e.prototype,"qmr.ResManager");var n;!function(t){t[t.LOW=-1]="LOW",t[t.HIGH=0]="HIGH",t[t.IMMEDIATELY=1]="IMMEDIATELY"}(n=t.LoadPriority||(t.LoadPriority={}));var r=function(){function t(){}return t.getPool=function(){var e=t._pool;return e||(e=[],t._pool=e),e},t.get=function(){var e,n=t.getPool();return e=n.length>0?n.pop():new o},t.recycle=function(e){e.reset();var n=t.getPool();n.push(e)},t}();__reflect(r.prototype,"LoaderPool");var o=function(){function e(){}return e.prototype.init=function(t,e,n,r,o,i,a,s){void 0===i&&(i=0),void 0===a&&(a=!1),void 0===s&&(s=null),this.callbackMananger=t,this.source=e,this.compFunc=n,this.thisObject=r,this.type=this.type,this.priority=i,this.isGroup=a,this.progFunc=s,this.loadCount=0},e.prototype.load=function(){if(this.loadCount++,this.isGroup)this.loadCount<=1&&(RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onGroupLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onGroupProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onGroupLoadCompleted,this)),RES.loadGroup(this.source);else{var t=!1;if(RES.hasRes(this.source)){t=!0;var e=RES.getRes(this.source);if(e)return void this.onGetResSuccess(e)}this.loadCount<=1&&RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),t?RES.getResAsync(this.source,this.onGetResSuccess,this):RES.getResByUrl(this.source,this.onGetResSuccess,this,this.type)}},e.prototype.reset=function(){this.isGroup?(RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onGroupLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onGroupProgress,this),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onGroupLoadCompleted,this)):RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.callbackMananger=null,this.source=null,this.compFunc=null,this.thisObject=null,this.type=null,this.priority=null,this.isGroup=!1,this.progFunc=null,this.loadCount=0},e.prototype.onGetResSuccess=function(t){this.callbackMananger&&this.callbackMananger(this,!0,t)},e.prototype.onItemLoadError=function(e){this.source==e.resItem.url&&(t.LogUtil.log("onItemLoadError",this.source),this.callbackMananger&&this.callbackMananger(this,!1))},e.prototype.onGroupLoadCompleted=function(t){this.source==t.groupName&&this.callbackMananger&&this.callbackMananger(this,!0)},e.prototype.onGroupLoadError=function(t){this.source==t.groupName&&this.callbackMananger&&this.callbackMananger(this,!1)},e.prototype.onGroupProgress=function(t){this.source==t.groupName&&this.progFunc&&this.progFunc(t.itemsLoaded/t.itemsTotal)},e}();__reflect(o.prototype,"Loader")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){this.onHideCount=0}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this;egret.lifecycle.onPause=function(){t.onPause()},egret.lifecycle.onResume=function(){t.onResume()}},e.prototype.onResume=function(){t.LogUtil.log("焦点触发"),t.SoundManager.getInstance().isMusicSoundOpen=e.bgSoundIsOpen,t.SoundManager.getInstance().isEffectSoundOpen=e.effectSoundIsOpen,t.PlatformManager.instance.platform.onShareBack()},e.prototype.onPause=function(){t.LogUtil.log("焦点失去"),e.instance.onHideCount++,e.bgSoundIsOpen=t.SoundManager.getInstance().isMusicSoundOpen,e.effectSoundIsOpen=t.SoundManager.getInstance().isEffectSoundOpen,t.SoundManager.getInstance().isMusicSoundOpen=!1,t.SoundManager.getInstance().isEffectSoundOpen=!1},e.bgSoundIsOpen=!0,e.effectSoundIsOpen=!0,e}();t.GameLifecycleManger=e,__reflect(e.prototype,"qmr.GameLifecycleManger")}(qmr||(qmr={}));var qmr;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.loadLoginRes=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return t.WebLoadingManager.setLoadingStatus("玩命加载中..."),[4,this.loadResJson("login.res.json","resourceLogin/")];case 1:return e.sent(),[4,this.loadThmJson("login.thm.json")];case 2:return e.sent(),[4,this.loadPreloadingGroup()];case 3:return e.sent(),t.PlatformManager.instance.platform.setLoadingProgress(50),[2]}})})},n.prototype.loadGameResAfterLogin=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.isGameResAfterLoginLoading?[2]:(this.isGameResAfterLoginLoading=!0,this.isGameResAfterLoginLoaded=!1,[4,this.loadLoadingViewRes()]);case 1:return t.sent(),this.setLoadingViewParams("加载资源配置...",!0,.05,.1,!1),this.setLoadingViewParams("加载皮肤配置...",!0,.1,.2,!0),[4,this.loadResJson("default.res.json")];case 2:return t.sent(),[4,this.loadDefaultThmJs()];case 3:return t.sent(),[4,this.loadThmJson("default.thm.json")];case 4:return t.sent(),this.setLoadingViewParams("加载游戏配置...",!0,.2,.5,!0),[4,this.loadConfigGroup()];case 5:return t.sent(),this.setLoadingViewParams("加载公共资源...",!0,.5,.9,!0),[4,this.loadCommonGroup()];case 6:return t.sent(),this.isGameResAfterLoginLoaded=!0,this.gameResAfterLoginLoadedCall&&this.gameResAfterLoginLoadedCall.call(this),[2]}})})},n.prototype.waiGameResAfterLoginLoaded=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},n.prototype.loadLoadingViewRes=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(n){return[2,new Promise(function(n,r){var o=1,i=0,a=function(){i++,i>=o&&n()};t.ResManager.getRes(t.WebLoadingManager.getBgName(),a,e,t.LoadPriority.IMMEDIATELY)})]})})},n.prototype.waitGameResLoaded=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return t=this,[2,new Promise(function(e,n){var r=function(){t.setLoadingViewParams("准备进入游戏...",!0,.99,.99,!0);var n=new egret.Timer(30,1);n.addEventListener(egret.TimerEvent.TIMER,function(){t.loadPreModel(),e()},t),n.start()};t.isGameResAfterLoginLoaded?(t.showLoadingView(),r()):(t.gameResAfterLoginLoadedCall=r,t.showLoadingView())})]})})},n.prototype.setLoadingViewParams=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.loadingViewparams=t,this.gameResAfterLoginLoadedCall&&this.showLoadingView()},n.prototype.showLoadingView=function(){this.loadingViewparams&&t.GameLoadingView.getInstance().showSelf(this.loadingViewparams[0],this.loadingViewparams[1],this.loadingViewparams[2],this.loadingViewparams[3],this.loadingViewparams[4])},n.prototype.updateTotalProgress=function(e){var n=t.ModuleManager.isShowModule(t.ModuleNameLogin.GAME_LOADING_VIEW);n&&t.GameLoadingView.getInstance().updateTotalProgress(e,!0)},n.prototype.loaderSilentResource=function(e,n,r){void 0===n&&(n=null),void 0===r&&(r=0);for(var o=this,i=null,a=null,s=0,c=e;s<c.length;s++){var l=c[s];a=l.path,l.type?t.ResManager.getRes(a,n,o,r,l.type):(i=l.res,this.preLoadAnimation(l.path,i,r,n,o,l.harf),a=l.path+i+".png",t.LoaderManager.instance.addGroupRef(a))}},n.prototype.preLoadAnimation=function(e,n,r,o,i,a){void 0===r&&(r=0),void 0===o&&(o=null),void 0===i&&(i=null),void 0===a&&(a=!1);var s=n;if(a&&(s+="_f"),o){var c=!1,l=!1;t.ResManager.getRes(e+n+".json",function(t){c=!0,l&&o&&o.call(i)},this,r,RES.ResourceItem.TYPE_JSON),t.ResManager.getRes(e+s+".png",function(t){l=!0,c&&o&&o.call(i)},this,r,RES.ResourceItem.TYPE_IMAGE)}else t.ResManager.getRes(e+n+".json",null,null,r,RES.ResourceItem.TYPE_JSON),t.ResManager.getRes(e+s+".png",null,null,r,RES.ResourceItem.TYPE_IMAGE)},n.prototype.loadPreloadingGroup=function(){return __awaiter(this,void 0,void 0,function(){var e,n=this;return __generator(this,function(r){return e=this,[2,new Promise(function(r,o){var i=function(){r()};t.ResManager.loadGroup("loginPre",i,n,t.LoadPriority.IMMEDIATELY,e.updateTotalProgress)})]})})},n.prototype.loadCreateRoleThmJs=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,n){var r=function(){e()},o=function(t){};window.onScriptLoadedCallBack=r,window.onScriptLoadingProgressCallBack=o,window.loadJsForEgretGame?window.loadJsForEgretGame("createrole",t.VersionManager.getPathWithGameVersion):e()})]})})},n.prototype.loadDefaultThmJs=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,n){var r=function(){e()},o=function(t){};window.onScriptLoadedCallBack=r,window.onScriptLoadingProgressCallBack=o,window.loadJsForEgretGame?window.loadJsForEgretGame("game",t.VersionManager.getPathWithGameVersion):window.loadSub2?window.loadSub2():e()})]})})},n.prototype.loadResJson=function(e,n){return __awaiter(this,void 0,void 0,function(){var r=this;return __generator(this,function(o){return[2,new Promise(function(o,i){var a=function(){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,a,this),o()};RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,a,r),n||(n=t.PlatformConfig.baseRoot);var s=n;RES.loadConfig(s+e,s)})]})})},n.prototype.loadThmJson=function(e,n){return __awaiter(this,void 0,void 0,function(){var r=this;return __generator(this,function(o){return[2,new Promise(function(o,i){var a;n||(n=t.PlatformConfig.baseRoot);var s=n;a=new eui.Theme(s+e,t.StageUtil.stage);var c=function(){a.removeEventListener(eui.UIEvent.COMPLETE,c,this),o()};a.addEventListener(eui.UIEvent.COMPLETE,c,r)})]})})},n.prototype.loadConfigGroup=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(n){return[2,new Promise(function(n,r){var o=e,i=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,i,o),n()};RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,i,o),t.ResManager.loadGroup("config",i,e,t.LoadPriority.IMMEDIATELY,o.updateTotalProgress)})]})})},n.prototype.loadCommonGroup=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(n){return[2,new Promise(function(n,r){var o=e,i=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,i,o),n()};RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,i,o),t.ResManager.loadGroup("common",i,e,t.LoadPriority.IMMEDIATELY,o.updateTotalProgress)})]})})},n.prototype.loadPreModel=function(){},Object.defineProperty(n,"instance",{get:function(){return this._instance||(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n}(t.BaseNotify);t.GameLoadManager=e,__reflect(e.prototype,"qmr.GameLoadManager")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){this.mask=new egret.Sprite}return e.getLayerMaskSprite=function(){var n=t.Pool.getItemByClass("LayerMaskSprite",e);return n},e.recovryLayerMaskSprite=function(e){t.Pool.recover("LayerMaskSprite",e)},e.prototype.addMask=function(e,n){void 0===n&&(n=!1),this._isAlpha0=n,this.mask||(this.mask=new egret.Sprite),this.onStageResize(),this.mask.touchEnabled=!0,this.mask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickMaskHandler,this),t.LayerManager.instance.getLayer(e).addChild(this.mask),n||this.tweenAddMask()},e.prototype.onClickMaskHandler=function(e){if(this.mask&&this.mask.parent){var n=this.mask.parent.numChildren;if(n>1){var r=this.mask.parent.getChildAt(n-1);r instanceof t.SuperBaseModule&&r.isClickHide&&r.hide()}}},e.prototype.tweenAddMask=function(){this.mask&&this.mask.parent&&(egret.Tween.resumeTweens(this.mask),egret.Tween.get(this.mask).to({alpha:1},120))},e.prototype.tweenRemoveMask=function(){var t=this.mask;t&&t.parent&&(t.alpha>0?(t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickMaskHandler,this),egret.Tween.resumeTweens(t),egret.Tween.get(t).to({alpha:0},100).call(this.removeMask,this)):this.removeMask())},e.prototype.onStageResize=function(){var t=this.stageWidth,e=this.stageHeight;this.mask.graphics.clear(),this.mask.graphics.beginFill(0,this._isAlpha0?0:.6),this.mask.graphics.drawRect(0,0,t,e),this.mask.graphics.endFill(),this.mask.width=t,this.mask.height=e},e.prototype.removeMask=function(){var t=this.mask;t&&t.parent&&(t.graphics.clear(),t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickMaskHandler,this),t.parent.removeChild(t)),this.dispose()},Object.defineProperty(e.prototype,"stageWidth",{get:function(){return t.StageUtil.stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stageHeight",{get:function(){return t.StageUtil.stageHeight},enumerable:!0,configurable:!0}),e.prototype.reset=function(){},e.prototype.dispose=function(){this.reset(),e.recovryLayerMaskSprite(this)},e}();t.LayerMaskSprite=e,__reflect(e.prototype,"qmr.LayerMaskSprite")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){this.maxLivingTime=12e4;var e=this;e.groupNameDic={},t.Ticker.getInstance().registerTick(e.clearGroupTick,e,6e4)}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.addGroupRef=function(e){var n=this.groupNameDic[e];n||(this.groupNameDic[e]=n={});var r=n.count;r?r+=1:r=1,n.count=r,t.LogUtil.log("LoaderManager.addGroupRef:",e,r)},e.prototype.removeGroupRef=function(t){t in this.groupNameDic&&delete this.groupNameDic[t]},e.prototype.destoryGroup=function(e,n){void 0===n&&(n=!1);var r=this.groupNameDic[e];if(r){var o=r.count;if(o?o-=1:o=0,0>=o&&(o=0),r.count=o,t.LogUtil.log("LoaderManager.destoryGroup:",e,o),0==o&&(r.livingTime=egret.getTimer(),n)){var i=RES.destroyRes(e);t.LogUtil.warn("强制释放 "+e+"  "+i),this.groupNameDic[e]=null,delete this.groupNameDic[e]}}},e.prototype.clearGroupTick=function(){var e=egret.getTimer(),n=this.groupNameDic,r=this.maxLivingTime;for(var o in n){var i=n[o];if(0==i.count&&i.livingTime&&e-i.livingTime>r){var a=RES.destroyRes(o);t.LogUtil.warn("RES.destroyRes res:"+o+"  "+a),n[o]=null,delete n[o]}}t.ModuleManager.clearModuleTick(e,r),t.AnimateManager.getInstance().clear(e)},e}();t.LoaderManager=e,__reflect(e.prototype,"qmr.LoaderManager")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return e.connectGameServer=function(){var n=this,r=function(){t.GameLoading.getInstance().setLoadingTip("服务器连接成功..."),e.isConnected=!0,console.log("==========================服务器socket连接成功=========================="),t.ModuleManager.showModule(t.ModuleNameLogin.LOGIN_VIEW)};t.GameLoading.getInstance().setLoadingTip("正在连接服务器..."),t.Rpc.getInstance().connect(t.GlobalConfig.loginServer,t.GlobalConfig.loginPort,r,n)},e.isConnected=!1,e}();t.LoginManager=e,__reflect(e.prototype,"qmr.LoginManager")}(qmr||(qmr={}));var qmr;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.timeKey=-1,t}return __extends(n,e),Object.defineProperty(n,"instance",{get:function(){return null==this._instance&&(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.prototype.initListeners=function(){this.addSocketListener(t.MessageIDLogin.S_SYNC_TIME,this.onRecsynSystem,this),this.addSocketListener(t.MessageIDLogin.S_EXCEPTION_MSG,this.onRecExceptionMsg,this,!0)},n.prototype.startHeart=function(){this.isStartSysn||(this.isStartSysn=!0,this.timeFlag=Date.now(),this.timeKey=egret.setInterval(this.reqgetSystemTime,this,8e3),this.reqgetSystemTime())},n.prototype.clearHeart=function(){this.isStartSysn=!1,-1!=this.timeKey&&(egret.clearInterval(this.timeKey),this.timeKey=-1)},n.prototype.reqgetSystemTime=function(){var e=new com.message.C_SYNC_TIME;this.sendCmd(e,t.MessageIDLogin.C_SYNC_TIME)},n.prototype.onRecsynSystem=function(e){t.ServerTime.syncServerTime(parseInt(e.time.toString())),this.isSyncOne||(this.isSyncOne=!0,this.dispatch(t.NotifyConstLogin.SCNY_ONE_SERVER_TIME))},n.prototype.onRecExceptionMsg=function(e){var n=e.code,r=t.ConfigManager.getConf(t.ConfigEnumBase.CODECFG,n);r?t.TipManagerCommon.getInstance().showLanTip(r.msg):t.TipManagerCommon.getInstance().showLanTip("CN_167",n),t.GameLoading.getInstance().close()
},n}(t.BaseController);t.SystemController=e,__reflect(e.prototype,"qmr.SystemController")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){this.commonTipCdTime=500,this.commonMessInfo=[],this.isConmmoning=!1,this.commonTips=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.getmsg=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.shift();for(var r in t){var o=t[r];n=n.replace(/\{\d+\}/,o)}return n},e.prototype.showLanTip=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this,i=t.ConfigManager.getConf(t.ConfigEnumBase.CLIENTCN,e);if(!i)return void console.error("缺少语言配置id："+e);var a=t.GlobalConfig.isCN?i.value:i.en_value;n&&n.length>0&&(n.unshift(a),a=this.getmsg.apply(this,n)),o.createCommonTip(a)},e.prototype.createCommonTip=function(t,e,n){void 0===e&&(e=16777215),void 0===n&&(n=0);for(var r=!1,o=0,i=this.commonMessInfo;o<i.length;o++){var a=i[o];if(a.mess==t){r=!0;break}}r||this.commonMessInfo.push({mess:t,color:e,yPos:n}),this.isConmmoning||(this.isConmmoning=!0,this.showCommonTip())},e.prototype.recycleCommonTip=function(t){this.commonTips.push(t)},e.prototype.showCommonTip=function(){var e=this;if(this.isConmmoning){var n=this.commonMessInfo.shift();if(n){var r=this.commonTips.shift();r||(r=new t.CommonTip),t.LayerManager.instance.addDisplay(r,t.LayerConst.TOP),r.showTip(n),egret.setTimeout(function(){e.commonMessInfo.length?e.showCommonTip():e.isConmmoning=!1},this,this.commonTipCdTime)}}},e}();t.TipManagerCommon=e,__reflect(e.prototype,"qmr.TipManagerCommon")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return e.initGameVersion=function(e){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(r){return n=this,t.PlatformConfig.useCdnRes?(n.resVersion=e,[2,new Promise(function(e,r){var o=t.PlatformConfig.webUrl+n.defaultDir+"/"+n.resVersion+"/version.json";t.LogUtil.log("=========》》》加载版本控制文件："+o);var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,i.open(o,egret.HttpMethod.GET),i.send(),i.addEventListener(egret.Event.COMPLETE,function(t){var r=t.currentTarget,o=JSON.parse(r.response);n.versionConfig=o.verDic,n.defaultVer=o.defaultVer,e()},n),i.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){egret.error("post error : "+event),r()},n)})]):[2]})})},e.getPathWithGameVersion=function(n){var r=e.defaultVer;return e.versionConfig&&e.versionConfig[n]&&(r=e.versionConfig[n]),n=t.PlatformConfig.webUrl+e.defaultDir+"/"+r+"/"+n},e.defaultDir="ver",e}();t.VersionManager=e,__reflect(e.prototype,"qmr.VersionManager");var n=function(){function n(){}return n.prototype.init=function(){return Promise.resolve()},n.prototype.getVirtualUrl=function(e){return t.PlatformConfig.useCdnRes?this.getResUrlByVersion(e):e+"?v="+(new Date).getTime()},n.prototype.getResUrlByVersion=function(n){if(-1!=n.indexOf("eui_skins"))return n;var r=n.indexOf(t.PlatformConfig.baseRoot);if(-1==r)return n;var o,i=n.indexOf("?v=");o=-1!=i?n.slice(r,i):n.slice(r);var a=e.defaultVer;return e.versionConfig&&e.versionConfig[o]&&(a=e.versionConfig[o]),o=t.PlatformConfig.webUrl+e.defaultDir+"/"+a+"/"+o},n}();t.VersionController=n,__reflect(n.prototype,"qmr.VersionController",["RES.IVersionController"])}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return e.clearModuleTick=function(e,n){for(var r=this,o=r._cacheAppMap,i=o.keys,a=0,s=i;a<s.length;a++){var c=s[a],l=o.get(c);l?l.getEffective(e,n)||(o.remove(c),t.LogUtil.warn("ModuleManager.clear "+c)):t.LogUtil.error("ModuleManager.cacheAppMap变成空了？？ "+c)}},e.popModule=function(n,r,o,i,a){void 0===r&&(r=null),void 0===o&&(o=t.LayerConst.ALERT),void 0===i&&(i=!1),void 0===a&&(a=!0),e.showModule(n,r,o,i,a),t.SoundManager.getInstance().loadAndPlayEffect("SOUND_TANCHU")},e.showModule=function(e,n,r,o,i,a,s,c){void 0===n&&(n=null),void 0===r&&(r=t.LayerConst.BASE_UI),void 0===o&&(o=!0),void 0===i&&(i=!0),void 0===a&&(a=""),void 0===s&&(s=null),void 0===c&&(c=null);var l=this,u=l.getAppByClass(e);if(u){if(u.preModule=c,u.name=e,u.closeOpenPanel=a,u.closeOpenPanelData=s,i&&u.isShow)return-1!=l._NO_TRIGGER_MODULE.indexOf(e)?void u.show(n):void l.hideModule(e);o&&l.closeAllWindow(),u.show(n),l._currView=u,(u.isNeedMask||u.isNeedAlpha0Mask)&&(r=t.LayerConst.MASK_UI,u.maskSprite||(u.maskSprite=l.addMask(r,u.isNeedAlpha0Mask)));var p=u.groupName;void 0!=p&&""!=p&&(p.match("_json")?t.ResManager.getRes(p,null,l):t.ResManager.loadGroup(p),t.LoaderManager.instance.addGroupRef(p)),u.layer=r,t.LayerManager.instance.getLayer(r).addChild(u),u.title&&u.updateTitle(u.title,u.ruleId),t.LogUtil.log("[openModule:"+e+"]"),t.NotifyManager.sendNotification(t.NotifyConstLogin.OPEN_PANEL_VIEW,e),t.NotifyManager.sendNotification(t.NotifyConstLogin.OPEN_PANEL_LAYER,r)}l.sendToTop()},e.isShowModule=function(t){var e=this._cacheAppMap.get(t);return e?e.isShow:!1},e.hideModule=function(e,n){void 0===n&&(n=!1);var r,o=this,i=e;if(e instanceof t.SuperBaseModule?(r=e,i=r.name):r=o._cacheAppMap.get(e),r){if(!r.isShow)return;n?r.hide():o.disposWin(r),r.closeOpenPanel&&o.showModule(r.closeOpenPanel,r.closeOpenPanelData)}t.NotifyManager.sendNotification(t.NotifyConstLogin.CLOSE_PANEL_VIEW,i)},e.closeAllWindow=function(){for(var e,n=this,r=t.LayerManager.instance.getLayer(t.LayerConst.BASE_UI);r.numChildren;)e=r.getChildAt(0),n.disposWin(e);for(r=t.LayerManager.instance.getLayer(t.LayerConst.ALERT);r.numChildren;)e=r.getChildAt(0),n.disposWin(e)},e.getCurrentView=function(){return this._currView},e.closeCurrentModule=function(){this._currView&&this.disposWin(this._currView)},e.getAppByClass=function(e){if(null==e)return null;var n=egret.getTimer(),r=this,o=r._cacheAppMap.get(e),i=t.LoaderManager.instance.maxLivingTime;if(null==o||!o.getEffective(n,i)){var a=r.getClassName(e);o=new a,r._cacheAppMap.set(e,o)}return o},e.getSuperBaseModuleByClass=function(t){var e=this._cacheAppMap.get(t);return e&&e.stage?e:null},e.getComponentGlobalPoint=function(t,e){var n=this._cacheAppMap.get(t);return n?n.getComponentGlobalPoint(e):{x:0,y:0}},e.addMask=function(e,n){void 0===n&&(n=!1);var r=t.LayerMaskSprite.getLayerMaskSprite();return r.addMask(e,n),r},e.disposWin=function(n){n instanceof t.SuperBaseModule?(n.dispose(),n.maskSprite&&(n.maskSprite.tweenRemoveMask(),n.maskSprite=null),n.preModule&&n.preModule.parent&&(n.updateGuide(),n.preModule=null)):e.removeDisplay(n),this.sendToTop()},e.sendToTop=function(){var e=t.LayerManager.instance.getLayer(t.LayerConst.BASE_UI);t.NotifyManager.sendNotification(t.NotifyConstLogin.CLOSE_PANEL_LAYER,e.numChildren),this.sendToTopEvent()},e.sendToTopEvent=function(){t.NotifyManager.sendNotification(t.NotifyConstLogin.CHANGE_MODEL_VIEW)},e.deleteModule=function(t){this._cacheAppMap.remove(t)},e.setupClass=function(){var e=this;e.registerClass(t.ModuleNameLogin.LOGIN_VIEW,t.LoginView),e.registerClass(t.ModuleNameLogin.GAME_LOADING_VIEW,t.GameLoadingView),e.registerClass(t.ModuleNameLogin.DISCONNECT_VIEW,t.DisConnectView)},e.registerClass=function(t,e){this._classAppMap[t]=e},e.getClassName=function(t){return this._classAppMap[t]},e.removeDisplay=function(t,e){void 0===e&&(e=null),t&&(e||(e=t.parent),e&&e.removeChild(t))},e._classAppMap={},e._cacheAppMap=new t.Dictionary,e._NO_TRIGGER_MODULE=[],e.NO_RECHARGE_HIDE_VIEW=[],e.openPanelFromBattle=!1,e}();t.ModuleManager=e,__reflect(e.prototype,"qmr.ModuleManager")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.LOGIN_VIEW="qmr.LoginView",t.GAME_LOADING_VIEW="qmr.GameLoadingView",t.DISCONNECT_VIEW="qmr.DisConnectView",t}();t.ModuleNameLogin=e,__reflect(e.prototype,"qmr.ModuleNameLogin")}(qmr||(qmr={}));var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),qmr.GameMain.setup(this.stage)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var qmr;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.qmrSkinName="DisConnectSkin",t.isNeedMask=!0,t.isClickHide=!1,t.isCenter=!0,t}return __extends(n,e),n.prototype.initListener=function(){e.prototype.initListener.call(this),this.addEvent(this.btn_refresh,egret.TouchEvent.TOUCH_TAP,this.onRefresh,this)},n.prototype.onRefresh=function(){t.GameLoadingView.getInstance().closeVitureProgress(),t.PlatformManager.instance.platform.reloadGame()},n.prototype.initData=function(){e.prototype.initData.call(this);var t=this.data;t?(this.txt_tip.text=t.msg+"",this.txt_code.visible=!1,-1!=t.code&&(this.txt_code.text="错误码: "+t.code,this.txt_code.visible=!0)):(this.txt_tip.text="服务器链接不上",this.txt_code.text="请稍后重试")},n.prototype.dispose=function(){t.LogUtil.log("DisConnectView被释放了"),e.prototype.dispose.call(this)},n}(t.SuperBaseModule);t.DisConnectView=e,__reflect(e.prototype,"qmr.DisConnectView")}(qmr||(qmr={}));var qmr;!function(t){var e=function(e){function n(){var t=e.call(this)||this;t.vitureCount=0;var n=t;return n.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){n.hasEventListener(egret.Event.ENTER_FRAME)&&n.removeEventListener(egret.Event.ENTER_FRAME,n.runLoading,n)},n),n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){n.setProgress(0,1),n.addEventListener(egret.Event.ENTER_FRAME,n.runLoading,n)},n),n.touchEnabled=!0,t}return __extends(n,e),n.prototype.onTouch=function(t){t.stopImmediatePropagation()},n.prototype.runLoading=function(t){this._loadingRun&&(this._loadingRun.rotation+=3)},n.getInstance=function(){return null==n.inttance&&(n.inttance=new n),n.inttance},n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.rect=new eui.Rect,this.rect.fillColor=0,this.rect.fillAlpha=.2,this.addChild(this.rect),this.rect.touchEnabled=!0,this.rect.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this._loadingRun=new eui.Image(RES.getRes("preloading_loading_png")),this.addChild(this._loadingRun),this._txProgress=new eui.Label,this._txProgress.fontFamily="specialGameFont",this.addChild(this._txProgress),this.updateSize()},n.prototype.updateSize=function(){this._loadingRun.verticalCenter=0,this._loadingRun.horizontalCenter=0,this._txProgress.verticalCenter=0,this._txProgress.horizontalCenter=0,this._txProgress.size=20,this.rect.width=t.StageUtil.stageWidth,this.rect.height=t.StageUtil.stageHeight},n.prototype.setProgress=function(e,n){t.LayerManager.instance.addDisplay(this,t.LayerConst.TOP),this._txProgress&&(this._txProgress.text=Math.round(e/n*100)+"%",0==e?(this.vitureCount=1,t.Ticker.getInstance().registerTick(this.onTimer,this,50)):t.Ticker.getInstance().unRegisterTick(this.onTimer,this))},n.prototype.onTimer=function(){this.vitureCount++,this.vitureCount<100&&(this._txProgress.text=Math.round(this.vitureCount)+"%")},n.prototype.setLoadingTip=function(e){t.Ticker.getInstance().unRegisterTick(this.onTimer,this),t.NotifyManager.registerNotify(t.StageUtil.STAGE_RESIZE,this.updateSize,this),t.LayerManager.instance.addDisplay(this,t.LayerConst.TOP),this._txProgress&&(this._txProgress.text=e)},n.prototype.close=function(){t.NotifyManager.unRegisterNotify(t.StageUtil.STAGE_RESIZE,this.updateSize,this),t.Ticker.getInstance().unRegisterTick(this.onTimer,this),this.parent&&this.parent.removeChild(this)},n}(eui.Group);t.GameLoading=e,__reflect(e.prototype,"qmr.GameLoading")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return e.setup=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return t.WebBrowerUtil.initSysInfo(),[4,t.PlatformConfig.init()];case 1:return n.sent(),t.StageUtil.init(e),egret.ImageLoader.crossOrigin="anonymous",egret.registerImplementation("eui.IAssetAdapter",new AssetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.registerVersionController(new t.VersionController),t.MessageIDLogin.init(),t.LayerManager.instance.setup(t.StageUtil.stage),t.ModuleManager.setupClass(),t.LoginController.instance,t.SystemController.instance,t.GameLifecycleManger.instance.init(),this.initLocalStorage(),[4,t.GameLoadManager.instance.loadLoginRes()];case 2:return n.sent(),[4,t.PlatformManager.instance.platform.reqLogin()];case 3:return n.sent(),t.LoginManager.connectGameServer(),[2]}})})},e.initLocalStorage=function(){var e="0"==egret.localStorage.getItem("bgSoundIsOpen"),n="0"==egret.localStorage.getItem("effectSoundIsOpen");console.log("背景音乐是否关闭："+e),console.log("音效是否关闭："+n),t.SoundManager.getInstance().isMusicSoundOpen=!e,t.SoundManager.getInstance().isEffectSoundOpen=!n},e}();t.GameMain=e,__reflect(e.prototype,"qmr.GameMain")}(qmr||(qmr={}));var qmr;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.currentProgress=0,t.maxProgress=100,t.fromProgressTotal=0,t.dProgressTotal=1,t.HREF="event_refresh_game",t.needAdaptStatusBar=!1,t.skinName="GameLoadingViewSkin",t.progressBar1.visible=!0,t.progressBar2.visible=!0,t}return __extends(n,e),n.getInstance=function(){return n._instance||(n._instance=t.ModuleManager.getAppByClass(t.ModuleNameLogin.GAME_LOADING_VIEW)),n._instance},n.prototype.initComponent=function(){e.prototype.initComponent.call(this);var n=" 刷新游戏";t.PlatformManager.instance.platform.canClearResCache&&(n=" 清除缓存");var r=t.HtmlUtil.getHtmlTextElement("若长时间加载不成功，请点击",16777215),o=t.HtmlUtil.getHtmlTextElement(n,3276588,!0,this.HREF,1918992,1);this.labRefresh.textFlow=r.concat(o),this.labRefresh.touchEnabled=!0},n.prototype.initListener=function(){e.prototype.initListener.call(this),this.addEvent(this.labRefresh,egret.TextEvent.LINK,this.onRefresh,this)},n.prototype.addedToStage=function(n){e.prototype.addedToStage.call(this,n),this.imgBg.source=t.WebLoadingManager.getBgName()},n.prototype.showSelf=function(e,n,r,o,i){void 0===n&&(n=!0),void 0===r&&(r=0),void 0===o&&(o=1),void 0===i&&(i=!0),t.ModuleManager.isShowModule(t.ModuleNameLogin.GAME_LOADING_VIEW)||t.ModuleManager.showModule(t.ModuleNameLogin.GAME_LOADING_VIEW,null,t.LayerConst.LOADING,!1),this.setPrelMessage(e),this.fromProgressTotal>=.99&&(n=!1,i=!1),n?this.showVitureProgress():this.closeVitureProgress(),this.fromProgressTotal=r,this.dProgressTotal=o-r,this.updateTotalProgress(0,i)},n.prototype.hideSelf=function(){this.currentProgress=0,t.ModuleManager.isShowModule(t.ModuleNameLogin.GAME_LOADING_VIEW)&&t.ModuleManager.hideModule(t.ModuleNameLogin.GAME_LOADING_VIEW)},n.prototype.updateTotalProgress=function(t,e){void 0===e&&(e=!1),this.isShow&&(this.fromProgressTotal>=.99&&(this.closeVitureProgress(),e=!1),this.showTotalProgress(this.fromProgressTotal+t*this.dProgressTotal,e))},n.prototype.showVitureProgress=function(){var t=this;this.tid||(this.tid=setInterval(function(){t.updateAutoLoading()},50),this.updateAutoLoading())},n.prototype.closeVitureProgress=function(){this.tid&&(clearInterval(this.tid),this.tid=null),this.showPreProgress(1)},n.prototype.updateAutoLoading=function(){this.currentProgress<this.maxProgress?this.currentProgress+=10:this.currentProgress=0,this.showPreProgress(this.currentProgress/this.maxProgress)},n.prototype.onRefresh=function(e){t.PlatformManager.instance.platform.reloadGame(t.PlatformManager.instance.platform.canClearResCache)},n.prototype.setPrelMessage=function(t){this.progressBar1.setLoadingTip(t)},n.prototype.setTotalMessage=function(t){this.progressBar2.setLoadingTip(t)},n.prototype.showTotalProgress=function(t,e){void 0===e&&(e=!1),this.progressBar2.showProgressRate(t,e)},n.prototype.showPreProgress=function(t,e){void 0===e&&(e=!1),this.progressBar1.showProgressRate(t,e)},n.prototype.dispose=function(){this.currentProgress=0,this.closeVitureProgress(),e.prototype.dispose.call(this),t.LoaderManager.instance.destoryGroup("serverlist_loginBg_jpg")},n}(t.SuperBaseModule);t.GameLoadingView=e,__reflect(e.prototype,"qmr.GameLoadingView")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return e.setLoadingStatus=function(t){t=t||"";var e=window.showPreLoading;e&&e(t)},e.getBgName=function(){if(!e.bgName){var n=Math.floor(Math.random()*e.bgArray.length);e.bgName=t.SystemPath.getLoginResDir()+"unpack/"+e.bgArray[n]}return e.bgName},e.bgArray=["1022_map.jpg"],e}();t.WebLoadingManager=e,__reflect(e.prototype,"qmr.WebLoadingManager")}(qmr||(qmr={}));var qmr;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),Object.defineProperty(n,"instance",{get:function(){return null==this._instance&&(this._instance=new n),this._instance},enumerable:!0,configurable:!0}),n.prototype.initListeners=function(){var e=this;e.addSocketListener(t.MessageIDLogin.S_USER_LOGIN,e.onRecLoginSuccess,e,!0),e.addSocketListener(t.MessageIDLogin.S_USER_LOGOUT,e.onRecUseLoginOut,e,!0),e.addSocketListener(t.MessageIDLogin.S_LOGIN_REGISTER,e.onRegisterResponse,e,!0),e.addSocketListener(t.MessageIDLogin.S_SEND_VERIFY_CODE,e.onGetVerifyCodeResponse,e,!0),e.addSocketListener(t.MessageIDLogin.S_USER_LOGIN_BAN,e.onRecLoginBanResponse,e,!0)},n.prototype.onRecLoginBanResponse=function(e){t.TipManagerCommon.getInstance().showLanTip("CN_168"),t.GameLoading.getInstance().close()},n.prototype.reqVerifyCode=function(e,n){var r=new com.message.C_SEND_VERIFY_CODE;r.mobile=e,r.type=n,this.sendCmd(r,t.MessageIDLogin.C_SEND_VERIFY_CODE,!0)},n.prototype.onGetVerifyCodeResponse=function(e){egret.log("获取验证码手机号:"+e.mobile,"  结果:"+e.state),0==e.state?t.TipManagerCommon.getInstance().showLanTip("CN_169",!0):t.TipManagerCommon.getInstance().showLanTip("CN_170")},n.prototype.reqLogin=function(e,n){t.GameLoading.getInstance().setLoadingTip("CN_171"),egret.log("登陆账号:"+e,"参数:"+o);var r=new com.message.C_USER_LOGIN;r.mobile=e,r.password=n;var o={DeviceUID:"",ClientVersion:t.PlatformConfig.resVersion,ClientIp:""};r.sparam=JSON.stringify(o),r.fromGame=t.PlatformConfig.GameId,this.sendCmd(r,t.MessageIDLogin.C_USER_LOGIN,!0)},n.prototype.reqVerfiyCodeLogin=function(e,n){t.GameLoading.getInstance().setLoadingTip("CN_171"),egret.log("登陆账号:"+e,"参数:"+o);var r=new com.message.C_USER_LOGIN_VERIFY_CODE;r.mobile=e,r.verifyCode=n;var o={DeviceUID:"",ClientVersion:t.PlatformConfig.resVersion,ClientIp:""};r.sparam=JSON.stringify(o),r.fromGame=t.PlatformConfig.GameId,this.sendCmd(r,t.MessageIDLogin.C_USER_LOGIN_VERIFY_CODE,!0)},n.prototype.reqLoginRegister=function(e,n,r,o,i,a){void 0===a&&(a="");var s=new com.message.C_LOGIN_REGISTER;s.mobile=e,s.inviteCode=n,s.password=r,s.rePassword=o,s.verifyCode=i,s.sparam=a,s.fromGame=t.PlatformConfig.GameId,this.sendCmd(s,t.MessageIDLogin.C_LOGIN_REGISTER)},n.prototype.onRegisterResponse=function(e){t.LoginModel.instance.onRecRegisterSuccess(e),this.dispatch(t.NotifyConstLogin.S_LOGIN_REGISTER)},n.prototype.onRecLoginSuccess=function(e){t.LoginModel.instance.isReconnect?(t.GameLoading.getInstance().close(),t.PbGlobalCounter.maxReconnectCount=3,t.LogUtil.log("断线重连完成！！")):e.playerId?(t.LoginModel.instance.onRecLoginSuccess(e),this.dispatch(t.NotifyConstLogin.S_USER_LOGIN)):(t.GameLoading.getInstance().close(),t.TipManagerCommon.getInstance().showLanTip("CN_172"))},n.prototype.reqUserLogout=function(e){var n=new com.message.C_USER_LOGOUT;n.playerId=e,this.sendCmd(n,t.MessageIDLogin.C_USER_LOGOUT,!0)},n.prototype.onRecUseLoginOut=function(e){e.beKickOut?t.LoginModel.instance.isInstead=!0:t.LoginModel.instance.isDisconnect=!0,this.dispatch(t.NotifyConstLogin.S_USER_LOGOUT)},n.prototype.reqReconnect=function(){t.LoginModel.instance.isReconnect=!0,this.reqLogin(t.GlobalConfig.account,t.GlobalConfig.pwd)},n.prototype.reqRelogin=function(){t.LoginModel.instance.isReconnect=!1,this.reqLogin(t.GlobalConfig.account,t.GlobalConfig.pwd)},n}(t.BaseController);t.LoginController=e,__reflect(e.prototype,"qmr.LoginController")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.onRecLoginSuccess=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return t.GlobalConfig.userId=e.playerId.toString(),t.PlatformConfig.GameId=e.fromGame,[4,this.startEnterGame()];case 1:return n.sent(),[2]}})})},e.prototype.onRecRegisterSuccess=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return t.GlobalConfig.userId=e.playerId.toString(),t.PlatformConfig.GameId=e.fromGame,[4,this.startEnterGame()];case 1:return n.sent(),[2]}})})},e.prototype.startEnterGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return t.SystemController.instance.startHeart(),t.GlobalConfig.userId?(t.GameLoading.getInstance().close(),this.isEnterGame=!0,this.destoryLoginRes(),t.GameLoadManager.instance.loadGameResAfterLogin(),[4,t.GameLoadManager.instance.waitGameResLoaded()]):[3,2];case 1:return e.sent(),t.EntryAfterLogin.onEnterGame(),[3,3];case 2:t.TipManagerCommon.getInstance().showLanTip("CN_173"),e.label=3;case 3:return[2]}})})},e.prototype.destoryLoginRes=function(){var e=document.getElementById("preLoadBg");e&&e.parentNode&&e.parentNode.removeChild(e),t.ModuleManager.hideModule(t.ModuleNameLogin.LOGIN_VIEW,!0)},e}();t.LoginModel=e,__reflect(e.prototype,"qmr.LoginModel")}(qmr||(qmr={}));var qmr;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.__leftTime=0,t.qmrSkinName="LoginViewSkin",t}return __extends(n,e),n.prototype.initListener=function(){e.prototype.initListener.call(this);var n=this;n.addClickEvent(n.btn_login,n.startLogin,n),n.addClickEvent(n.btn_register_back,n.gotoRegisterView,n),n.addClickEvent(n.btn_register,n.startRegister,n),n.addClickEvent(n.btn_login_back,n.gotoLoginView,n),n.addClickEvent(n.btn_login_way,n.switchLoginWay,n),n.addClickEvent(n.btn_getCode,n.getVcode1,n),n.addClickEvent(n.btn_getCode2,n.getVcode2,n),n.registerNotify(t.NotifyConstLogin.S_LOGIN_REGISTER,n.gotoLoginView,n)},n.prototype.focusInTxtHandler=function(){this.scrollDocument(100)},n.prototype.scrollDocument=function(t){var e=function(){document&&document.body&&(console.log(Math.random()),setTimeout(function(){window.scrollTo&&window.scrollTo(0,t)},200))};e()},n.prototype.oPasswordChange=function(){var t=this,e=t.txt_password.text.trim();if(e.length>0){for(var n="",r=0;r<e.length;r++)n+="*";t.txt_password.text=n}},n.prototype.getVcode1=function(){if(this.__leftTime>0)return void t.TipManagerCommon.getInstance().showLanTip("CN_174");var e=this.txt_account.text.trim();return 0==e.length?void t.TipManagerCommon.getInstance().showLanTip("CN_175"):t.HtmlUtil.isPhoneNumber(e)?(t.LoginController.instance.reqVerifyCode(e,1),this.__leftTime=59,void this.updateCd()):void t.TipManagerCommon.getInstance().showLanTip("CN_176")},n.prototype.getVcode2=function(){if(this.__leftTime>0)return void t.TipManagerCommon.getInstance().showLanTip("CN_174");var e=this.txt_register_tel.text.trim();return t.HtmlUtil.isPhoneNumber(e)?(t.LoginController.instance.reqVerifyCode(e,2),this.__leftTime=59,void this.updateCd()):void t.TipManagerCommon.getInstance().showLanTip("CN_176")},n.prototype.switchLoginWay=function(){var e=this;t.GlobalConfig.loginType=0==t.GlobalConfig.loginType?1:0,e.showLoginType()},n.prototype.gotoRegisterView=function(){this.group_login.visible=!1,this.group_register.visible=!0},n.prototype.gotoLoginView=function(){this.group_login.visible=!0,this.group_register.visible=!1},n.prototype.startRegister=function(){if(!t.LoginManager.isConnected)return void t.TipManagerCommon.getInstance().showLanTip("CN_177");var e=this.txt_register_tel.text.trim(),n=this.txt_register_invitecode.text.trim(),r=this.txt_register_pwd.text.trim(),o=this.txt_register_repwd.text.trim(),i=this.txt_register_verifycode.text.trim();return t.HtmlUtil.isPhoneNumber(e)?0==n.length?void t.TipManagerCommon.getInstance().showLanTip("CN_178"):r.length<6?void t.TipManagerCommon.getInstance().showLanTip("CN_179"):0==o.length?void t.TipManagerCommon.getInstance().showLanTip("CN_180"):o!==r?void t.TipManagerCommon.getInstance().showLanTip("CN_181"):0==i.length?void t.TipManagerCommon.getInstance().showLanTip("CN_182"):void t.LoginController.instance.reqLoginRegister(e,n,r,o,i):void t.TipManagerCommon.getInstance().showLanTip("CN_176")},n.prototype.startLogin=function(){if(!t.LoginManager.isConnected)return void t.TipManagerCommon.getInstance().showLanTip("CN_177");var e=this.txt_account.text.trim();if(0==e.length)return void t.TipManagerCommon.getInstance().showLanTip("CN_175");if(!t.HtmlUtil.isPhoneNumber(e))return void t.TipManagerCommon.getInstance().showLanTip("CN_176");var n;if(0==t.GlobalConfig.loginType){if(n=this.txt_password.text.trim(),0==n.length)return void t.TipManagerCommon.getInstance().showLanTip("CN_183");if(n.length<0)return void t.TipManagerCommon.getInstance().showLanTip("CN_179")}else if(1==t.GlobalConfig.loginType&&(n=this.txt_vcode.text.trim(),0==n.length))return void t.TipManagerCommon.getInstance().showLanTip("CN_182");0==t.GlobalConfig.loginType?(t.GlobalConfig.account=e,t.GlobalConfig.pwd=n,t.LoginController.instance.reqLogin(e,n)):1==t.GlobalConfig.loginType&&(t.GlobalConfig.telephone=e,t.GlobalConfig.verifyCode=n,t.LoginController.instance.reqVerfiyCodeLogin(e,n)),egret.localStorage.setItem("testUserid",t.GlobalConfig.account)},n.prototype.addedToStage=function(n){e.prototype.addedToStage.call(this,n);var r=document.getElementById("gameLoading");r&&r.parentNode&&r.parentNode.removeChild(r);var o=document.getElementById("style");o&&o.parentNode&&o.parentNode.removeChild(o),t.GameLoading.getInstance().close(),t.WebLoadingManager.setLoadingStatus(""),t.GameLoadManager.instance.loadGameResAfterLogin(),this.onBgResBack(),this.addWindEffect()},n.prototype.onBgResBack=function(){if(t.LogUtil.log("onBgResBack"),document&&document.getElementById("loaingMyBg")){var e=document.getElementById("loaingMyBg");e.style.display="none"}},n.prototype.addWindEffect=function(){this.imgWindSlow.source="serverlist_wind_png",this.imgWindFast.source="serverlist_wind_png",this.imgWindMiddle.source="serverlist_wind_png";var e=12e3;this.imgWindSlow.x=this.stage.stageWidth,this.imgWindFast.x=this.stage.stageWidth,this.imgWindMiddle.x=this.stage.stageWidth;var n=-800;t.LogUtil.log("this.imgWindSlow.width",this.imgWindSlow.width),egret.Tween.get(this.imgWindSlow,{loop:!0}).to({x:n},e),egret.Tween.get(this.imgWindFast,{loop:!0}).to({x:n},e/2),egret.Tween.get(this.imgWindMiddle,{loop:!0}).to({x:n},e/1.5)},n.prototype.initData=function(){e.prototype.initData.call(this);var t=this;t.txt_account.text=egret.localStorage.getItem("testUserid"),t.updateView()},n.prototype.updateView=function(){var e=this,n=t.HtmlUtil.getQueryStringByName("code"),r=t.HtmlUtil.getQueryStringByName("register");n&&"1"==r?(e.group_login.visible=!1,e.group_register.visible=!0,e.txt_register_invitecode.text=n):(e.group_login.visible=!0,e.group_register.visible=!1),e.showLoginType()},n.prototype.updateCd=function(){var e=this;e.__leftTime>0?(-1!=e.__timekey&&egret.clearInterval(e.__timekey),e.__timekey=egret.setInterval(e.updateTime,e,1e3),e.txt_vcodeDes.text=e.txt_vcodeDes2.text=t.CommonTool.formatTime1(e.__leftTime)+"s"):e.stopTime()},n.prototype.updateTime=function(){var e=this;return this.__leftTime<=0?void(e.txt_vcodeDes.text=e.txt_vcodeDes2.text="获取验证码"):(e.txt_vcodeDes.text=e.txt_vcodeDes2.text=t.CommonTool.formatTime1(e.__leftTime)+"s",void e.__leftTime--)},n.prototype.stopTime=function(){var t=this;-1!=t.__timekey&&egret.clearInterval(t.__timekey),t.__timekey=-1,t.txt_vcodeDes.text=t.txt_vcodeDes2.text=""},n.prototype.showLoginType=function(){var e=this;0==t.GlobalConfig.loginType?(e.btn_login_way.textFlow=t.HtmlUtil.getHtmlString("<font><u>短信登录</u></font>"),e.group_pwd.visible=!0,e.group_vcode.visible=!1,e.btn_getCode.visible=!1):(e.btn_login_way.textFlow=t.HtmlUtil.getHtmlString("<font><u>账号密码登录</u></font>"),e.group_pwd.visible=!1,e.group_vcode.visible=!0,e.btn_getCode.visible=!0)},n.prototype.dispose=function(){e.prototype.dispose.call(this),egret.Tween.removeTweens(this.imgWindSlow),egret.Tween.removeTweens(this.imgWindFast),egret.Tween.removeTweens(this.imgWindMiddle),t.ModuleManager.deleteModule(t.ModuleNameLogin.LOGIN_VIEW);var n=RES.destroyRes("login");t.LogUtil.log("RES.destroyRes,login=",n)},n}(t.SuperBaseModule);t.LoginView=e,__reflect(e.prototype,"qmr.LoginView")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t}();t.LoginInfoVo=e,__reflect(e.prototype,"qmr.LoginInfoVo")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return e.init=function(){var t,e=this;for(var n in e)t=e[n],e.MSG_KEYS.set(t,n)},e.getMsgNameById=function(t){return e.MSG_KEYS.get(t)},e.MSG_KEYS=new t.Dictionary,e.S_EXCEPTION_MSG=900,e.C_SEND_VERIFY_CODE=1019,e.S_SEND_VERIFY_CODE=1020,e.C_USER_LOGIN=1001,e.S_USER_LOGIN=1002,e.S_USER_LOGIN_BAN=1003,e.C_USER_LOGIN_VERIFY_CODE=1004,e.C_LOGIN_REGISTER=1005,e.S_LOGIN_REGISTER=1006,e.C_USER_LOGOUT=1007,e.S_USER_LOGOUT=1008,e.C_SYNC_TIME=2101,e.S_SYNC_TIME=2102,e.C_SEND_SDK_DATA=1032,e.S_SEND_SDK_DATA=1033,e}();t.MessageIDLogin=e,__reflect(e.prototype,"qmr.MessageIDLogin")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){this.msgIdMap={},this.msgIdMap[t.MessageIDLogin.S_EXCEPTION_MSG]=com.message.S_EXCEPTION_MSG,this.msgIdMap[t.MessageIDLogin.S_USER_LOGIN]=com.message.S_USER_LOGIN,this.msgIdMap[t.MessageIDLogin.S_USER_LOGOUT]=com.message.S_USER_LOGOUT,this.msgIdMap[t.MessageIDLogin.C_SYNC_TIME]=com.message.C_SYNC_TIME,this.msgIdMap[t.MessageIDLogin.S_SYNC_TIME]=com.message.S_SYNC_TIME}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e}();t.ProtoMsgIdMapLogin=e,__reflect(e.prototype,"qmr.ProtoMsgIdMapLogin")}(qmr||(qmr={}));var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var qmr;!function(t){var e=function(){function t(){}return t.registerNotify=function(e,n,r){var o=t.typeDic,i=o[e];if(i){for(var a=!1,s=0,c=i;s<c.length;s++){var l=c[s];if(l.callback==n&&l.thisObject==r){a=!0;break}}a||(i.push({callback:n,thisObject:r}),o[e]=i)}else o[e]=[{callback:n,thisObject:r}]},t.unRegisterNotify=function(e,n,r){var o=t.typeDic[e];if(o){for(var i=0,a=o;i<a.length;i++){var s=a[i];if(s.callback==n&&s.thisObject==r){var c=o.indexOf(s);-1!=c&&o.splice(c,1);break}}0==o.length?delete t.typeDic[e]:t.typeDic[e]=o}},t.unRegisterNotifyByType=function(e){delete t.typeDic[e]},t.hasNotification=function(e){var n=t.typeDic[e];return n?n.length>0:!1},t.sendNotification=function(e,n){void 0===n&&(n=null);var r=t.typeDic[e];if(r)for(var o=r.length,i=void 0,a=o-1;a>=0;a--)i=r[a],i&&i.callback&&i.callback.call(i.thisObject,n)},t.sendNotificationSplit=function(e,n){void 0===n&&(n=null);var r=t.typeDic[e],o=[];if(r){for(var i=r.length,a=void 0,s=i-1;s>=0;s--)a=r[s],a&&a.callback&&(o[s]||(o[s]={}),o[s].callback=a.callback,o[s].thisObject=a.thisObject,o[s].params=a.params);t.splitTypeDic.push(o)}},t.removeThisObjectNofity=function(e){var n=t.typeDic;
for(var r in n){for(var o=n[r],i=o.length-1;i>=0;i--)o[i].thisObject==e&&o.splice(i,1);0==o.length?delete n[r]:n[r]=o}},t.test=function(){console.warn("NotifyManager.typeDic=======================================================>"),console.warn(t.typeDic),console.warn("egret.ticker=======================================================>"),console.warn(egret.ticker)},t.typeDic={},t.splitTypeDic=[],t.logDic={},t}();t.NotifyManager=e,__reflect(e.prototype,"qmr.NotifyManager")}(qmr||(qmr={}));var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,r){function o(t){e.call(r,t)}function i(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),n.call(r))}var a=this;if("undefined"!=typeof generateEUI)qmr.LogUtil.log("[url:"+t+"]"),egret.callLater(function(){e.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,n){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(r,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var s=t.split("/");s.pop();var c=s.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(r,generateJSON.paths[t])},this):RES.getResByUrl(c,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){e.call(r,generateJSON.paths[t])},a)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var qmr;!function(t){var e=function(){function e(){}return e.init=function(){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(r){switch(r.label){case 0:if(e=this,n=window.GAME_CONFIG,!n)throw new Error("platfrom config is not define");return e.GAME_CONFIG=n,e.platformId=Number(n.platformId),e.channelId=n.channelId,e.isNeedMarkPoint=n.isMarkPoint,e.isTSVersion=!!Number(n.isTSVersion),n.isWSS&&(e.isWSS=!!Number(n.isWSS)),e.isShildTSV=!!Number(n.isShildTSV),e.isShieldIOSBusiness=!!Number(n.isShieldIOSBusiness),e.isOpenGM=!!Number(Number(n.isOpenGM)),e.isDebug=!!Number(n.isDebug),e.extendsParams=n.extendsParams,e.platformClassType=n.platformClassType,e.useCdnRes=!!Number(n.isPublish),e.baseRoot=n.basePath,e.webUrl=n.resPath,e.webRoot=e.webUrl+e.baseRoot,n.isShowNotice&&(e.isShowNotice=!!Number(n.isShowNotice)),n.max_hw_ratio&&(t.StageUtil.MAX_HW_RATIO=Math.min(t.StageUtil.MAX_HW_RATIO,n.max_hw_ratio)),n.min_hw_ratio&&(t.StageUtil.MIN_HW_RATIO=Math.max(t.StageUtil.MIN_HW_RATIO,n.min_hw_ratio)),e.connectAddress=n.connectAddress,e.GameId=Number(n.GameId),e.appIdStr=n.appId,e.appKey=n.appKey,e.platform=n.platform,e.platformSign=n.platformSign,e.serverDomain=n.serverDomain,e.ts_serverDomain=n.ts_serverDomain,e.markPointDomain=n.markPointServer,e.ossDoamin=n.ossServer,e.resVersion=n.resVersion,e.InviteAddress=n.InviteAddress,e.AppDownAddress=n.AppDownAddress,[4,t.VersionManager.initGameVersion(e.resVersion)];case 1:return r.sent(),[2]}})})},e.GAME_CONFIG=null,e.platformId=0,e.channelId="0",e.isNeedMarkPoint=!0,e.isTSVersion=!1,e.isShildTSV=!1,e.isShieldIOSBusiness=!1,e.isOpenGM=!1,e.isShowNotice=!0,e.isWSS=!0,e.extendsParams="",e.useCdnRes=!1,e.baseRoot="",e.webUrl="",e.webRoot="",e.GameId=1,e}();t.PlatformConfig=e,__reflect(e.prototype,"qmr.PlatformConfig")}(qmr||(qmr={}));var qmr;!function(t){var e;!function(t){t[t.P_SLOGAME_DEBUG=1]="P_SLOGAME_DEBUG",t[t.P_SLOGAME_WEB=100]="P_SLOGAME_WEB"}(e=t.PlatformEnum||(t.PlatformEnum={}))}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return e.creatPlatform=function(e){var n;switch(e){case t.PlatformEnum.P_SLOGAME_DEBUG:n=new t.CommonGamePlatform;break;case t.PlatformEnum.P_SLOGAME_WEB:n=new t.WebGamePlatform}return n},e}();t.PlatformFactory=e,__reflect(e.prototype,"qmr.PlatformFactory")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){this._platform=t.PlatformFactory.creatPlatform(t.PlatformConfig.platformId)}return e.prototype.reportRegister=function(){this.platform.reportRegister()},e.prototype.reportLogin=function(){this.platform.reportLogin()},e.prototype.reqPay=function(t){},e.prototype.reportUpLevel=function(){this.platform.reportUpLevel()},e.prototype.shareGame=function(t,e,n){this.platform.shareGame(t,e,n)},Object.defineProperty(e.prototype,"platform",{get:function(){return this._platform},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOutNetPlatForm",{get:function(){return t.PlatformConfig.platformId!=t.PlatformEnum.P_SLOGAME_DEBUG},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGetPlatformInfo",{get:function(){return this.platform.isGetPlatformInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e)},enumerable:!0,configurable:!0}),e}();t.PlatformManager=e,__reflect(e.prototype,"qmr.PlatformManager")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.ORDER_URL="{0}//{1}/api/{2}.orderid_{3}.php",t.SVRLISTOP_URL="{0}//{1}/api/{2}.svrlist_{3}.php",t.TS_SVRLISTOP_URL="{0}//{1}/api/{2}.svrlist_{3}_ts.php",t.QUERY_URL="{0}//{1}/api/{2}.query_{3}.php",t.FORBIDDEN_URL="{0}//{1}/api/{2}.forbidden_{3}.php",t.LASTLOGIN_URL="{0}//{1}/api/{2}.lastlogin_{3}.php",t.LOGIN_URL="{0}//{1}/api/{2}.login_{3}.php",t.WORD_URL="{0}//{1}/api/dirtycli.php",t.NOTICE_URL="{0}//{1}/api/gm/getserver_notice.php",t.VERIFY_URL="{0}//{1}/api/{2}.validation.php",t}();t.PlatformUrlConsont=e,__reflect(e.prototype,"qmr.PlatformUrlConsont")}(qmr||(qmr={}));var qmr;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.canClearResCache=!1,t}return __extends(n,e),n.prototype.initGetOption=function(){t.PlatformConfig.platformSign=t.PlatformConfig.platform+"",this.isGetPlatformInfo=!0},n.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){return egret.log("平台登陆"),[2,new Promise(function(e,n){t.isGetPlatformInfo=!0,e(),egret.log("平台登陆成功:"+status)})]})})},n.prototype.reqPay=function(t){},n.prototype.pay=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},n}(t.BasePlatform);t.CommonGamePlatform=e,__reflect(e.prototype,"qmr.CommonGamePlatform")}(qmr||(qmr={}));var qmr;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.canClearResCache=!1,t}return __extends(n,e),n.prototype.initGetOption=function(){t.PlatformConfig.platformSign=t.PlatformConfig.platform+"",this.isGetPlatformInfo=!0},n.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){return egret.log("平台登陆"),[2,new Promise(function(e,n){t.isGetPlatformInfo=!0,e(),egret.log("平台登陆成功:"+status)})]})})},n.prototype.reqPay=function(t){},n.prototype.pay=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},n}(t.BasePlatform);t.WebGamePlatform=e,__reflect(e.prototype,"qmr.WebGamePlatform")}(qmr||(qmr={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function r(r){e.call(n,r,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?r(o):RES.getResAsync(t,r,this)}else RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var qmr;!function(t){var e=function(){function t(){}return t.getServerSecond=function(){return Math.floor((egret.getTimer()+this.tickOffset)/1e3)},Object.defineProperty(t,"serverTime",{get:function(){return egret.getTimer()+this.tickOffset},enumerable:!0,configurable:!0}),t.getSeverDate=function(){return new Date(1e3*this.getServerSecond())},t.getZoneOffsetSeverDate=function(){return new Date(1e3*this.getZoneOffsetSeverSecond())},t.getZoneOffsetSeverSecond=function(){return this.getServerSecond()},t.syncServerTime=function(t){this.tickOffset=t-egret.getTimer()},t.tickOffset=0,t}();t.ServerTime=e,__reflect(e.prototype,"qmr.ServerTime")}(qmr||(qmr={}));var ServerTime=qmr.ServerTime,qmr;!function(t){var e=function(){function e(){}return e.parseMsg=function(n){var r=n.readInt()-e.ADD_L,o=n.readInt(),i=t.ByteArrayPool.getInstance().createByte();n.readBytes(i,0,r);var a=this.decryptForDis(i);t.ByteArrayPool.getInstance().recycleByte(i),t.Rpc.getInstance().onDataIn(o,a),t.ByteArrayPool.getInstance().recycleByte(a)},e.getSendMsg=function(n,r,o){void 0===o&&(o=!1);var i=t.MessageIDLogin.getMsgNameById(r);if(t.MessageID&&t.MessageID.getMsgNameById){var a=t.MessageID.getMsgNameById(r);a&&(i=a)}var s,c=com.message[i].encode(n).finish(),l=c.byteLength;if(void 0==i||void 0==r)return t.LogUtil.log("[send:error:"+n+"]"),s;o&&t.PlatformConfig.isDebug&&t.LogUtil.log("[C_S:"+r+" "+i+"] msgLength:"+l);var u=this.encryptForDis(c,l);return s=t.ByteArrayPool.getInstance().createByte(),s.writeInt(l+e.ADD_L),s.writeInt(r),s.writeBytes(u),t.ByteArrayPool.getInstance().recycleByte(u),s},e.encryptForDis=function(e,n){var r=t.ByteArrayPool.getInstance().createByte();r._writeUint8Array(e);for(var o,i=r.bytes,a=0;n>a&&!(a+3>n-1);a+=5)o=~i[a+2],i[a+2]=i[a+3],i[a+3]=o;return r},e.decryptForDis=function(e){var n=t.ByteArrayPool.getInstance().createByte();n.writeBytes(e);for(var r,o=n.bytes,i=o.byteLength,a=0;i>a&&!(a+3>i-1);a+=5)r=o[a+2],o[a+2]=~o[a+3],o[a+3]=r;return n},e.KEY="",e.ADD_L=4,e}();t.BufferGid=e,__reflect(e.prototype,"qmr.BufferGid")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){this.byteList=[];for(var t=0;20>t;t++){var e=new egret.ByteArray;e.endian=egret.Endian.BIG_ENDIAN,this.byteList.push(e)}}return t.getInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.createByte=function(){if(this.byteList.length>0)return this.byteList.shift();var t=new egret.ByteArray;return t.endian=egret.Endian.BIG_ENDIAN,t},t.prototype.recycleByte=function(t){t.clear(),this.byteList.push(t)},t}();t.ByteArrayPool=e,__reflect(e.prototype,"qmr.ByteArrayPool")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){this._counter=-1}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.getCountter=function(){return this._counter+=1,this._counter},t.prototype.resetCounter=function(){this._counter=-1},t.maxReconnectCount=3,t}();t.PbGlobalCounter=e,__reflect(e.prototype,"qmr.PbGlobalCounter")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t}();t.RequestHandler=e,__reflect(e.prototype,"qmr.RequestHandler")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){this.eventPool={},this.callbackPool={}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addSocketListener=function(e,n,r,o){if(void 0===o&&(o=!1),null!=this.eventPool[e])return void t.LogUtil.error("[error = addSocketListener 添加重复的消息 msgId="+e+"]");var i=new t.RequestHandler;i.callBack=n,i.thisObject=r,i.isRpc=!1,i.isLog=o,this.eventPool[e]=i},e.prototype.removeSocketListener=function(t,e,n){this.eventPool[t]&&delete this.eventPool[t]},e.prototype.connect=function(e,n,r,o){this.close(),this.loginSocket=new t.WebSocket,this.loginSocket.connect(e,n,function(){r.call(o)},this.onConnectClose,this.onConnectClose,this)},e.prototype.sendCmd=function(t,e,n){void 0===n&&(n=!1),this.loginSocket&&this.loginSocket.sendCmd(t,e,n)},e.prototype.rpcCMD=function(e,n,r,o,i,a,s,c){if(void 0===a&&(a=null),void 0===s&&(s=10),void 0===c&&(c=!1),null!=this.callbackPool[e])return void t.LogUtil.warn("[error = rpcCMD 添加重复的消息 eventMsgId="+e+"]");var l=new t.RequestHandler;l.callBack=o,l.thisObject=i,l.timeOutCallBack=a,l.timeOut=s,l.isRpc=!0,l.isLog=c,l.sendTime=Date.now(),this.callbackPool[e]=l,this.sendCmd(n,r,c),t.Ticker.getInstance().unRegisterTick(this.checkTimeOut,this),t.Ticker.getInstance().registerTick(this.checkTimeOut,this,1e3)},e.prototype.onDataIn=function(e,n){var r=t.ProtoMsgIdMapLogin.instance.msgIdMap;t.ProtoMsgIdMap&&t.ProtoMsgIdMap.instance&&t.ProtoMsgIdMap.instance.msgIdMap&&(r=t.ProtoMsgIdMap.instance.msgIdMap);var o=r[e];if(null==o)return void t.LogUtil.error("[尚未注册 ProtoMsgIdMap.instance.msgIdMap["+e+"] = null]");var i=n.buffer,a=new Uint8Array(i),s=o.decode(a),c=this.eventPool[e];c?(c.isLog&&t.LogUtil.log("[S_C:"+e+" "+o.name+"]"),c.clientData?c.callBack.call(c.thisObject,s,c.clientData):c.callBack.call(c.thisObject,s),c=null):t.LogUtil.error("[未监听协议 [msgId="+e+"]");var l=this.callbackPool[e];l&&l.callBack&&(delete this.callbackPool[e],l.clientData?l.callBack.call(l.thisObject,s,l.clientData):l.callBack.call(l.thisObject,s),l=null)},Object.defineProperty(e.prototype,"isconnect",{get:function(){return this.loginSocket?this.loginSocket.isconnected:!0},enumerable:!0,configurable:!0}),e.prototype.onConnectClose=function(){var n=this;t.PbGlobalCounter.getInstance().resetCounter(),t.SystemController.instance.clearHeart(),t.LoginModel.instance.isInstead?n.showDisConnectView("您的账号在另一台设备登录，请重新登录"):t.LoginModel.instance.isDisconnect?n.showDisConnectView("CN_187"):t.PbGlobalCounter.maxReconnectCount>0?(t.PbGlobalCounter.maxReconnectCount--,e.getInstance().close(),t.LoginModel.instance.isEnterGame?(t.GameLoading.getInstance().setLoadingTip("重连中"),egret.setTimeout(function(){e.getInstance().startReConnect()},n,2e3)):egret.setTimeout(function(){e.getInstance().startReLogin()},n,2e3)):t.LoginModel.instance.isEnterGame?n.showDisConnectView("CN_186"):(t.PbGlobalCounter.maxReconnectCount=3,e.getInstance().close(),t.GameLoading.getInstance().close(),t.TipManagerCommon.getInstance().showLanTip("CN_185"))},e.prototype.showDisConnectView=function(e){t.GameLoading.getInstance().close(),t.ModuleManager.showModule(t.ModuleNameLogin.DISCONNECT_VIEW,{msg:e,code:-1},t.LayerConst.TIP,!0,!1)},e.prototype.startReConnect=function(){this.connect(t.GlobalConfig.loginServer,t.GlobalConfig.loginPort,this.onGameServerConnect,this)},e.prototype.onGameServerConnect=function(){t.GameLoading.getInstance().setLoadingTip("CN_188"),t.LoginController.instance.reqReconnect()},e.prototype.startReLogin=function(){this.connect(t.GlobalConfig.loginServer,t.GlobalConfig.loginPort,this.onGameLoginServerConnect,this)},e.prototype.onGameLoginServerConnect=function(){t.GameLoading.getInstance().setLoadingTip("CN_189"),t.LoginController.instance.reqRelogin()},e.prototype.onConnnectError=function(){t.PbGlobalCounter.getInstance().resetCounter(),t.LogUtil.log("ioerror")},e.prototype.close=function(){this.loginSocket&&(this.loginSocket.dispos(),this.loginSocket=null)},e.prototype.fnErrorTrap=function(){},e.prototype.checkTimeOut=function(){var t=this.callbackPool;for(var e in t){var n=t[e];n&&n.isRpc&&Date.now()-n.sendTime>1e3*n.timeOut&&delete t[e]}},e}();t.Rpc=e,__reflect(e.prototype,"qmr.Rpc")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){this.WEB_KEY="/ws",this.websocket=new egret.WebSocket,this.websocket.type=egret.WebSocket.TYPE_BINARY,this.websocket.addEventListener(egret.Event.CONNECT,this.onSocketConnected,this),this.websocket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.websocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onDataIn,this),this.websocket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onIoError,this)}return e.prototype.connect=function(e,n,r,o,i,a){this.connectCallBack=r,this.connectCloseBack=o,this.connectErrorBack=i,this.thisObject=a;var s=t.PlatformManager.instance,c="";s.isOutNetPlatForm;c=t.PlatformConfig.connectAddress,this.websocket.connectByUrl(c),this.clearConTimeout(),this.tid=egret.setTimeout(this.onTimeOut,this,1e4),t.LogUtil.log("链接的服务器和端口:"+c)},e.prototype.onTimeOut=function(){this.clearConTimeout(),this.connectCloseBack&&this.connectCloseBack.call(this.thisObject),t.LogUtil.log("10秒链接不上超时")},e.prototype.onSocketConnected=function(e){this._isConnect=!0,this.clearConTimeout(),this.connectCallBack&&this.connectCallBack.call(this.thisObject),t.LogUtil.log("连接服务器成功！")},e.prototype.onSocketClose=function(e){this._isConnect=!1,this.clearConTimeout(),this.connectCloseBack&&this.connectCloseBack.call(this.thisObject),t.LogUtil.log("服务器连接关闭")},e.prototype.onDataIn=function(e){if(this.websocket){var n=t.ByteArrayPool.getInstance().createByte();for(this.websocket.readBytes(n);n.bytesAvailable;)t.BufferGid.parseMsg(n);t.ByteArrayPool.getInstance().recycleByte(n)}},e.prototype.onIoError=function(e){this._isConnect=!1,this.clearConTimeout(),this.connectErrorBack&&this.connectErrorBack.call(this.thisObject),t.LogUtil.log("服务器连接错误")},e.prototype.sendCmd=function(e,n,r){if(void 0===r&&(r=!1),this.isconnected){var o=t.BufferGid.getSendMsg(e,n,r);o&&(this.websocket.writeBytes(o),this.websocket.flush(),t.ByteArrayPool.getInstance().recycleByte(o)),e=null}},Object.defineProperty(e.prototype,"isconnected",{get:function(){return this._isConnect&&this.websocket&&this.websocket.connected},enumerable:!0,configurable:!0}),e.prototype.clearConTimeout=function(){this.tid&&(egret.clearTimeout(this.tid),this.tid=0)},e.prototype.dispos=function(){var t=this;t.clearConTimeout(),null!=t.websocket&&(t.websocket.removeEventListener(egret.Event.CONNECT,t.onSocketConnected,t),t.websocket.removeEventListener(egret.Event.CLOSE,t.onSocketClose,t),t.websocket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,t.onDataIn,t),t.websocket.removeEventListener(egret.IOErrorEvent.IO_ERROR,t.onIoError,t),t.isconnected&&(t._isConnect=!1,t.websocket.close()),t.websocket=null),t.connectCallBack=null,t.connectCloseBack=null,t.connectErrorBack=null,t.thisObject=null},e}();t.WebSocket=e,__reflect(e.prototype,"qmr.WebSocket")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=egret.Sound.EFFECT),this.sound=t,this.isPlay=!1,this.type=e,null!=t&&(this.sound.type=e)}return t.prototype.play=function(t,e){void 0===e&&(e=0),null!=this.sound&&(this.isPlay=!0,this.soundChannel=this.sound.play(t,e),this.soundChannel.once(egret.Event.SOUND_COMPLETE,this.onPlayerEnd,this),this.sound.type==egret.Sound.MUSIC&&(this.soundChannel.volume=.7))},t.prototype.onPlayerEnd=function(){this.isPlay=!1},t.prototype.stop=function(){null!=this.sound&&(this.isPlay=!1,null!=this.soundChannel&&this.soundChannel.stop())},Object.defineProperty(t.prototype,"position",{get:function(){return this.soundChannel?this.soundChannel.position:0},enumerable:!0,configurable:!0}),t}();t.SoundItem=e,__reflect(e.prototype,"qmr.SoundItem")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){this._isEffectSoundOpen=!0,this._isMusicSoundOpen=!0,this._isMusicLifecycleOpen=!0,this._soundCfgDic=new t.Dictionary,this._lastMusicName="",this._musicName="",this._soundPool={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},Object.defineProperty(e.prototype,"soundPool",{get:function(){return this._soundPool},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEffectSoundOpen",{get:function(){return this._isEffectSoundOpen},set:function(t){if(this._isEffectSoundOpen=t,!t)for(var e in this._soundPool){var n=this._soundPool[e];null!=n&&null!=n.sound&&n.sound.type==egret.Sound.EFFECT&&n.stop()}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMusicSoundOpen",{get:function(){return this._isMusicSoundOpen},set:function(t){this._isMusicSoundOpen=t,t?(null!=this._bgSoundItem&&this._bgSoundItem.stop(),""!=this._musicName&&(this._bgSoundItem=this._soundPool[this._musicName],this._bgSoundItem?(this._lastMusicName=this._musicName,this._bgSoundItem.play(0)):this.loadBgMusic(this._musicName))):null!=this._bgSoundItem&&this._bgSoundItem.stop()},enumerable:!0,configurable:!0}),e.prototype.loadAndPlayEffect=function(e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=!1),this._isMusicLifecycleOpen&&this._isEffectSoundOpen){var o=this._soundPool,i=this.getSoundCfg(e);if(!i)return void t.LogUtil.log("音效不存在。。。"+e);var a=i.soundName;if(void 0==a||""==a)return;var s=o[a],c=i.isPlaySameTime>0;if(null==s){var l=RES.getRes(a+"_mp3");if(l){var u=o[a];u||(s=new t.SoundItem(l),o[a]=s),!c||r?!s.isPlay&&s.position<=0&&s.play(0,n):s.play(0,n)}else t.ResManager.getRes(t.SystemPath.getEffect_musicUrl(a),function(e){var i=o[a];if(!i){var s=new t.SoundItem(e);o[a]=s,!c||r?!s.isPlay&&s.position<=0&&s.play(0,n):s.play(0,n)}},this,t.LoadPriority.HIGH,RES.ResourceItem.TYPE_SOUND)}else!c||r?!s.isPlay&&s.position<=0&&s.play(0,n):s.play(0,n)}},e.prototype.stopSoundEffect=function(t){var e=this.getMusicName(t);if(void 0!=e&&""!=e&&this._isEffectSoundOpen){var n=this._soundPool[e];null!=n&&n.stop()}},e.prototype.loadAndPlayMusic=function(t){this._musicName=t,null!=t&&""!=t&&this._isMusicLifecycleOpen&&this._isMusicSoundOpen&&(null!=this._bgSoundItem?this._lastMusicName==t?this._bgSoundItem.position<=0&&(this._bgSoundItem.stop(),this._bgSoundItem.play(0)):(this._bgSoundItem&&this._bgSoundItem.stop(),this._bgSoundItem=this._soundPool[t],this._bgSoundItem?(this._lastMusicName=t,e.getInstance().isMusicSoundOpen&&this._bgSoundItem.play(0)):this.loadBgMusic(t)):this.loadBgMusic(t))},e.prototype.getMusicName=function(e){var n=this.getSoundCfg(e);return n?n.soundName:(t.LogUtil.log("音效不存在。。。"+e),"")},e.prototype.getMusicIsPlaySameTime=function(e){var n=this.getSoundCfg(e);return n?n.isPlaySameTime:(t.LogUtil.log("音效不存在。。。"+e),0)},e.prototype.getSoundCfg=function(e){if(this._soundCfgDic.has(e))return this._soundCfgDic.get(e);var n=t.ConfigManager.getConf(t.ConfigEnumBase.MUSIC,e);return n&&this._soundCfgDic.set(e,n),n},e.prototype.loadBgMusic=function(n){var r=this.getMusicName(n);if(void 0!=r&&""!=r){this._lastMusicName=r;var o=this;t.ResManager.getRes(t.SystemPath.bg_music+r+".mp3",function(r){var i=new t.SoundItem(r,egret.Sound.MUSIC);o._soundPool[n]=i,o._bgSoundItem&&o._bgSoundItem.stop(),o._bgSoundItem=i,e.getInstance().isMusicSoundOpen&&o._bgSoundItem.play(0)},this,t.LoadPriority.LOW,RES.ResourceItem.TYPE_SOUND)}},e.prototype.stopMusic=function(){var t=this._bgSoundItem;null!=t&&t.isPlay&&t.stop(),this._isMusicLifecycleOpen=!1},e.prototype.reStartMusic=function(){this._isMusicLifecycleOpen||(this._isMusicLifecycleOpen=!0,this.loadAndPlayMusic(this._lastMusicName))},e}();t.SoundManager=e,__reflect(e.prototype,"qmr.SoundManager")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){this.scale=1,this.eventList=[],this._running=!1,this.start()}return Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.start=function(){if(!this._running){for(var t=0,e=this.eventList;t<e.length;t++){var n=e[t];n&&(n.lastCount=n.updateInterval,n.lastTimeStamp=egret.getTimer())}egret.startTick(this.update,this),this._running=!0}},t.prototype.update=function(t){for(var e=0,n=this.eventList;e<n.length;e++){var r=n[e];if(r){var o=t-r.lastTimeStamp;if(o*=this.scale,o>=r.delay){var i=Math.floor(o/r.delay);for(i>4&&(i=4);i>0;)if(i--,0==r.repeatCount)r.callBack&&(r.params?r.callBack.call(r.thisObject,r.params):r.callBack.call(r.thisObject));else{r.currentCount++;var a=r.repeatCount>0&&r.currentCount>=r.repeatCount;if(a){r.callBack&&(r.params?r.callBack.call(r.thisObject,r.params):r.callBack.call(r.thisObject));var s=this.eventList.indexOf(r);-1!=s&&this.eventList.splice(s,1)}}r.lastTimeStamp=t,r.lastCount=r.updateInterval}else{if(r.lastCount-=1e3*this.scale,r.lastCount>0)continue;if(r.lastCount+=r.updateInterval,r.lastTimeStamp=t,r.currentCount++,0==r.repeatCount)r.callBack&&(r.params?r.callBack.call(r.thisObject,r.params):r.callBack.call(r.thisObject));else{var a=r.repeatCount>0&&r.currentCount>=r.repeatCount;if(a){r.callBack&&(r.params?r.callBack.call(r.thisObject,r.params):r.callBack.call(r.thisObject));var s=this.eventList.indexOf(r);-1!=s&&this.eventList.splice(s,1)}}}}}return!1},t.prototype.stop=function(){this._running&&(egret.stopTick(this.update,this),this._running=!1)},Object.defineProperty(t.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),t.prototype.registerTick=function(t,e,r,o,i){void 0===r&&(r=1e3),void 0===o&&(o=0),void 0===i&&(i=null);for(var a=!0,s=0,c=this.eventList;s<c.length;s++){var l=c[s];if(l.callBack==t&&l.thisObject==e){l.update(r,o),l.params=i,a=!1;break}}if(a){var u=new n(r,o);u.callBack=t,u.params=i,u.thisObject=e,this.eventList.push(u)}},t.prototype.unRegisterTick=function(t,e){for(var n=0,r=this.eventList;n<r.length;n++){var o=r[n];if(o.callBack==t&&o.thisObject==e){var i=this.eventList.indexOf(o);-1!=i&&this.eventList.splice(i,1);break}}},t.prototype.clearAllTick=function(){this.eventList.length=0},t.prototype.test=function(){console.warn("FightTicker:eventList.length...............................",this.eventList.length),console.warn(this.eventList)},t}();t.FightTimer=e,__reflect(e.prototype,"qmr.FightTimer");var n=function(){function t(t,e){void 0===e&&(e=0),this.lastTimeStamp=0,this.currentCount=0,this.update(t,e)}return t.prototype.update=function(t,e){void 0===e&&(e=0),this.currentCount=0,1>t&&(t=1),this._delay!=t&&(this._delay=t,this.lastCount=this.updateInterval=Math.round(60*t),this.lastTimeStamp=egret.getTimer(),this._repeatCount=0|+e)},Object.defineProperty(t.prototype,"delay",{get:function(){return this._delay},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"repeatCount",{get:function(){return this._repeatCount},enumerable:!0,configurable:!0}),t}();__reflect(n.prototype,"TickParams")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){this.eventList=[],this._running=!1,this.start()}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.start=function(){if(!this._running){for(var t=0,e=this.eventList;t<e.length;t++){var n=e[t];n&&(n.lastCount=n.updateInterval,n.lastTimeStamp=egret.getTimer())}egret.startTick(this.update,this),this._running=!0}},t.prototype.update=function(t){for(var e=0,n=this.eventList;e<n.length;e++){var r=n[e];if(r){var o=t-r.lastTimeStamp;if(o>=r.delay){var i=Math.floor(o/r.delay);for(i>4&&(i=4);i>0;)if(i--,0==r.repeatCount)r.callBack&&r.callBack.call(r.thisObject);else{r.currentCount++;var a=r.repeatCount>0&&r.currentCount>=r.repeatCount;if(a){r.callBack&&r.callBack.call(r.thisObject);var s=this.eventList.indexOf(r);-1!=s&&this.eventList.splice(s,1)}}r.lastTimeStamp=t,r.lastCount=r.updateInterval}else{if(r.lastCount-=1e3,r.lastCount>0)continue;if(r.lastCount+=r.updateInterval,r.lastTimeStamp=t,r.currentCount++,0==r.repeatCount)r.callBack&&r.callBack.call(r.thisObject);else{var a=r.repeatCount>0&&r.currentCount>=r.repeatCount;if(a){r.callBack&&r.callBack.call(r.thisObject);var s=this.eventList.indexOf(r);-1!=s&&this.eventList.splice(s,1)}}}}}return!1},t.prototype.stop=function(){this._running&&(egret.stopTick(this.update,this),this._running=!1)},Object.defineProperty(t.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),t.prototype.registerTick=function(t,e,r,o){void 0===r&&(r=1e3),void 0===o&&(o=0);for(var i=!0,a=this.eventList,s=0,c=a;s<c.length;s++){var l=c[s];if(l.callBack==t&&l.thisObject==e){l.update(r,o),i=!1;break}}if(i){var u=new n(r,o);u.callBack=t,u.thisObject=e,a.push(u)}},t.prototype.unRegisterTick=function(t,e){for(var n=this.eventList,r=0,o=n;r<o.length;r++){var i=o[r];if(i.callBack==t&&i.thisObject==e){var a=n.indexOf(i);-1!=a&&n.splice(a,1);break}}},t.prototype.test=function(){console.warn("Ticker info......................................................",this.eventList.length),console.warn(this.eventList)},t}();t.Ticker=e,__reflect(e.prototype,"qmr.Ticker");var n=function(){function t(t,e){void 0===e&&(e=0),this.lastTimeStamp=0,this.currentCount=0,this.update(t,e)}return t.prototype.update=function(t,e){void 0===e&&(e=0),this.currentCount=0,1>t&&(t=1),this._delay!=t&&(this._delay=t,this.lastCount=this.updateInterval=Math.round(60*t),this.lastTimeStamp=egret.getTimer(),this._repeatCount=0|+e)},Object.defineProperty(t.prototype,"delay",{get:function(){return this._delay},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"repeatCount",{get:function(){return this._repeatCount},enumerable:!0,configurable:!0}),t}();__reflect(n.prototype,"TickParams")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.checkAvalibe=function(t,e){var n=!1;return 1==(t>>e-1&1)&&(n=!0),n},t.changeBit=function(t,e,n){var r=Math.pow(2,e-1);return t&r?n||(t-=r):n&&(t+=r),t},t.inToBytes=function(t){var e=[];return e[0]=t>>24&255,e[1]=t>>16&255,e[2]=t>>8&255,e[3]=255&t,e},t}();t.BitUtil=e,__reflect(e.prototype,"qmr.BitUtil")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.loadScript=function(t,e,n){var r=window.document.createElement("script");r.type="text/javascript",e?r.src=decodeURIComponent(t):r.src=t,window.document.head.appendChild(r),r.onload=function(){r.onload=null,n()}},t}();t.ChannelUtil=e,__reflect(e.prototype,"qmr.ChannelUtil")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.getMsg=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.shift();for(var r in t){var o=t[r];n=n.replace(/\{\d+\}/,o)}return n},t.formatTime1=function(t){var e=Math.floor(t/60)%60,n=Math.floor(t%60),r=10>e?"0"+e:e.toString(),o=10>n?"0"+n:n.toString();return r+":"+o},t}();t.CommonTool=e,__reflect(e.prototype,"qmr.CommonTool")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(t,e,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1),this.resJson=t,this.spriteSheet=e,this.autoHalfTexture=r,this.autoParseTexture=n,this.framesList=[]}return t.prototype.parseClip=function(t){var e=this,n=0,r=this.framesList;e._frameRate=parseInt(t.frameRate);for(var o=0,i=t.frames;o<i.length;o++){var a=i[o],s=parseInt(a.duration);isNaN(s)&&(s=1);for(var c=1;s>=c;c++)n+=1,r.push(a)}if(e.autoParseTexture)for(var l=e.spriteSheet,u=e.autoHalfTexture,p=0,f=r;p<f.length;p++){var g=f[p];if(!l.getTexture(g.res)){var h=e.resJson[g.res];u?l.createTexture(g.res,Math.ceil(h.x/2),Math.ceil(h.y/2),h.w>>1,h.h>>1):l.createTexture(g.res,h.x,h.y,h.w,h.h)}}e._totalFrames=e.framesList.length},t.prototype.parseClipByStartAndEnd=function(t,e,n){var r=this,o=0,i=r.framesList;r._frameRate=parseInt(t.frameRate);for(var a=0,s=t.frames;a<s.length;a++){var c=s[a],l=parseInt(c.duration);isNaN(l)&&(l=1);for(var u=1;l>=u;u++)o+=1,o>=e&&n>=o&&i.push(c)}r._totalFrames=i.length},t.prototype.getTextureByFrame=function(t){var e,n=this;if(!(t<=n.framesList.length))return null;e=n.framesList[t-1];var r=n.spriteSheet.getTexture(e.res);if(!r){var o=n.resJson[e.res];r=n.spriteSheet.createTexture(e.res,o.x,o.y,o.w,o.h)}return r},t.prototype.getOffset=function(t){var e,n=this.framesList;if(e=t<=n.length?n[t-1]:n[n.length-1],this.autoHalfTexture){var r=this.resJson[e.res],o=r.x%2?1:0,i=r.y%2?1:0;return{x:e.x+o,y:e.y+i,w:r.w>>1<<1,h:r.h>>1<<1}}return e},Object.defineProperty(t.prototype,"totalFrames",{get:function(){return this._totalFrames},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"halfTexture",{get:function(){return this.autoHalfTexture},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frameRate",{get:function(){return this._frameRate},enumerable:!0,configurable:!0}),t.prototype.dispos=function(){this.framesList.length=0,this.framesList=null},t}();t.AnimateData=e,__reflect(e.prototype,"qmr.AnimateData")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.getDir=function(e){return 5>=e?e:6==e?t.RIGHT_DOWN:7==e?t.RIGHT:8==e?t.RIGHT_UP:void 0},t.UP=1,t.RIGHT_UP=2,t.RIGHT=3,t.RIGHT_DOWN=4,t.DOWN=5,t.LEFT_DOWN=6,t.LEFT=7,t.LEFT_UP=8,t}();t.DirUtil=e,__reflect(e.prototype,"qmr.DirUtil")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return e.getHtmlString=function(t){if(t.indexOf("\\n")>-1){var n=t.split("\\n").join("\n");
return e.htmlParse.parse(n)}return e.htmlParse.parse(t)},e.getHtmlTextElement=function(t,n,r,o,i,a){void 0===r&&(r=!1);var s="<font color="+n;return o&&(s+=" href=event:"+o),r&&(s+=" u='true'"),i&&(s+=" strokecolor="+i),a&&(s+=" stroke="+a),s+=">"+t+"</font>",e.getHtmlString(s)},e.getHtmlText=function(t,e,n,r){return void 0===n&&(n=!1),r&&n?"<font color="+e+" href=event:"+r+" u='true'>"+t+"</font>":r?"<font color="+e+" href=event:"+r+">"+t+"</font>":n?"<font color="+e+" u='true'>"+t+"</font>":"<font color="+e+">"+t+"</font>"},e.getColorSize=function(t,e,n){return n?"<font color="+e+" size="+n+">"+t+"</font>":"<font color="+e+">"+t+"</font>"},e.getHtmlTexts=function(t){for(var e=[],n=0;n<t.length;n++)e.push(this.getHtmlText(t[n][1],t[n][0],t[n][2],t[n][3]));return e.join("")},e.getItemHtmlText=function(t,e){var n="";return n},e.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r="args:";for(var o in e){if(!t.PlatformConfig.isDebug||!e)return;r+=e[o]+"\n"}return r},e.getQueryStringByName=function(t){var e=location.search.match(new RegExp("[?&]"+t+"=([^&]+)","i"));return null==e||e.length<1?"":e[1]},e.isPhoneNumber=function(t){if(!t)return!1;if(e.IsInteger(t))return 11==String(t).length},e.IsInteger=function(t){var e=t.trim();if(0!=e.length){var n=new RegExp(/^[-+]?\d*$/);if(!n.test(e))return!1}return!0},e.htmlParse=new egret.HtmlTextParser,e}();t.HtmlUtil=e,__reflect(e.prototype,"qmr.HtmlUtil")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return e.setItemIcon=function(e,n,r,o){void 0===o&&(o=!1),n&&""!=n&&(e.source=null,1==o&&(n+="_g"),t.ResManager.getRes(t.SystemPath.itemIcon+n+".png",function(t){e&&(e.source=t)},this,t.LoadPriority.HIGH,RES.ResourceItem.TYPE_IMAGE))},e.setBmpIcon=function(e,n){t.ResManager.getRes(n,function(t){e&&(e.texture=t)},this,t.LoadPriority.HIGH,RES.ResourceItem.TYPE_IMAGE)},e.decoratePathForGray=function(t){var e=t.split(".png");return t=e[0]+"_g.png"},e.setImageIcon=function(e,n){""!=n&&null!=n&&null!=e&&e.source!=n&&(e.source=null,t.ResManager.getRes(n,function(t){e&&(e.source=t)},this,t.LoadPriority.HIGH,RES.ResourceItem.TYPE_IMAGE))},e.setFilter=function(t){for(var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],n=new egret.ColorMatrixFilter(e),r=0;r<t.length;r++)t[r].filters=[n]},e}();t.ImageUtil=e,__reflect(e.prototype,"qmr.ImageUtil")}(qmr||(qmr={}));var qmr;!function(t){function e(t){return null==t?0:"number"==typeof t?t:parseFloat(t.toString())}function n(t){var e=t%1e4;return e}function r(t,r){var o=e(t),i=n(o);return"S"+i+"."+r}var o=function(){function t(){}return t.getNumber=function(t){return null==t||""==t||isNaN(t)?0:"number"==typeof t?t:parseFloat(t.toString())},t.getNumberArr=function(e){var n=new Array;if(e)for(var r=void 0,o=0;o<e.length;o++)r=t.getNumber(e[o]),n.push(r);return n},t}();t.Int64Util=o,__reflect(o.prototype,"qmr.Int64Util"),t.getNumber=e,t.getServerNumber=n,t.getServerNickName=r}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return e.log=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];t.PlatformConfig.isDebug&&console.log.apply(console,[e].concat(n))},e.saveLogAndShowLog=function(t,n){e.reportLogData.logKey=n,egret.log(n)},e.logF=function(e){t.GlobalConfig.isDebugF&&egret.log(e)},e.warn=function(e){t.PlatformConfig.isDebug&&egret.warn(e)},e.error=function(e){t.PlatformConfig.isDebug&&egret.error(e)},e.slowLog=function(e){t.GlobalConfig.bIsShowSlowLog&&console.log(e)},e.errorLogUrl="v1/artisan/uploadlog",e.reportLogData={},e}();t.LogUtil=e,__reflect(e.prototype,"qmr.LogUtil")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){this.hexcase=0,this.b64pad=""}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.any_hmac_md5=function(t,e,n){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),n)},t.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.rstr_hmac_md5=function(t,e){var n=this.rstr2binl(t);n.length>16&&(n=this.binl_md5(n,8*t.length));for(var r=Array(16),o=Array(16),i=0;16>i;i++)r[i]=909522486^n[i],o[i]=1549556828^n[i];var a=this.binl_md5(r.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(o.concat(a),640))},t.prototype.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var n,r=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",o="",i=0;i<t.length;i++)n=t.charCodeAt(i),o+=r.charAt(n>>>4&15)+r.charAt(15&n);return o},t.prototype.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="",o=t.length,i=0;o>i;i+=3)for(var a=t.charCodeAt(i)<<16|(o>i+1?t.charCodeAt(i+1)<<8:0)|(o>i+2?t.charCodeAt(i+2):0),s=0;4>s;s++)r+=8*i+6*s>8*t.length?this.b64pad:n.charAt(a>>>6*(3-s)&63);return r},t.prototype.rstr2any=function(t,e){var n,r,o,i,a,s=e.length,c=Array(Math.ceil(t.length/2));for(n=0;n<c.length;n++)c[n]=t.charCodeAt(2*n)<<8|t.charCodeAt(2*n+1);var l=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),u=Array(l);for(r=0;l>r;r++){for(a=Array(),i=0,n=0;n<c.length;n++)i=(i<<16)+c[n],o=Math.floor(i/s),i-=o*s,(a.length>0||o>0)&&(a[a.length]=o);u[r]=i,c=a}var p="";for(n=u.length-1;n>=0;n--)p+=e.charAt(u[n]);return p},t.prototype.str2rstr_utf8=function(t){for(var e,n,r="",o=-1;++o<t.length;)e=t.charCodeAt(o),n=o+1<t.length?t.charCodeAt(o+1):0,e>=55296&&56319>=e&&n>=56320&&57343>=n&&(e=65536+((1023&e)<<10)+(1023&n),o++),127>=e?r+=String.fromCharCode(e):2047>=e?r+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?r+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(r+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return r},t.prototype.str2rstr_utf16le=function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(255&t.charCodeAt(n),t.charCodeAt(n)>>>8&255);return e},t.prototype.str2rstr_utf16be=function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t.charCodeAt(n)>>>8&255,255&t.charCodeAt(n));return e},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),n=0;n<e.length;n++)e[n]=0;for(var n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e},t.prototype.binl2rstr=function(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var n=1732584193,r=-271733879,o=-1732584194,i=271733878,a=0;a<t.length;a+=16){var s=n,c=r,l=o,u=i;n=this.md5_ff(n,r,o,i,t[a+0],7,-680876936),i=this.md5_ff(i,n,r,o,t[a+1],12,-389564586),o=this.md5_ff(o,i,n,r,t[a+2],17,606105819),r=this.md5_ff(r,o,i,n,t[a+3],22,-1044525330),n=this.md5_ff(n,r,o,i,t[a+4],7,-176418897),i=this.md5_ff(i,n,r,o,t[a+5],12,1200080426),o=this.md5_ff(o,i,n,r,t[a+6],17,-1473231341),r=this.md5_ff(r,o,i,n,t[a+7],22,-45705983),n=this.md5_ff(n,r,o,i,t[a+8],7,1770035416),i=this.md5_ff(i,n,r,o,t[a+9],12,-1958414417),o=this.md5_ff(o,i,n,r,t[a+10],17,-42063),r=this.md5_ff(r,o,i,n,t[a+11],22,-1990404162),n=this.md5_ff(n,r,o,i,t[a+12],7,1804603682),i=this.md5_ff(i,n,r,o,t[a+13],12,-40341101),o=this.md5_ff(o,i,n,r,t[a+14],17,-1502002290),r=this.md5_ff(r,o,i,n,t[a+15],22,1236535329),n=this.md5_gg(n,r,o,i,t[a+1],5,-165796510),i=this.md5_gg(i,n,r,o,t[a+6],9,-1069501632),o=this.md5_gg(o,i,n,r,t[a+11],14,643717713),r=this.md5_gg(r,o,i,n,t[a+0],20,-373897302),n=this.md5_gg(n,r,o,i,t[a+5],5,-701558691),i=this.md5_gg(i,n,r,o,t[a+10],9,38016083),o=this.md5_gg(o,i,n,r,t[a+15],14,-660478335),r=this.md5_gg(r,o,i,n,t[a+4],20,-405537848),n=this.md5_gg(n,r,o,i,t[a+9],5,568446438),i=this.md5_gg(i,n,r,o,t[a+14],9,-1019803690),o=this.md5_gg(o,i,n,r,t[a+3],14,-187363961),r=this.md5_gg(r,o,i,n,t[a+8],20,1163531501),n=this.md5_gg(n,r,o,i,t[a+13],5,-1444681467),i=this.md5_gg(i,n,r,o,t[a+2],9,-51403784),o=this.md5_gg(o,i,n,r,t[a+7],14,1735328473),r=this.md5_gg(r,o,i,n,t[a+12],20,-1926607734),n=this.md5_hh(n,r,o,i,t[a+5],4,-378558),i=this.md5_hh(i,n,r,o,t[a+8],11,-2022574463),o=this.md5_hh(o,i,n,r,t[a+11],16,1839030562),r=this.md5_hh(r,o,i,n,t[a+14],23,-35309556),n=this.md5_hh(n,r,o,i,t[a+1],4,-1530992060),i=this.md5_hh(i,n,r,o,t[a+4],11,1272893353),o=this.md5_hh(o,i,n,r,t[a+7],16,-155497632),r=this.md5_hh(r,o,i,n,t[a+10],23,-1094730640),n=this.md5_hh(n,r,o,i,t[a+13],4,681279174),i=this.md5_hh(i,n,r,o,t[a+0],11,-358537222),o=this.md5_hh(o,i,n,r,t[a+3],16,-722521979),r=this.md5_hh(r,o,i,n,t[a+6],23,76029189),n=this.md5_hh(n,r,o,i,t[a+9],4,-640364487),i=this.md5_hh(i,n,r,o,t[a+12],11,-421815835),o=this.md5_hh(o,i,n,r,t[a+15],16,530742520),r=this.md5_hh(r,o,i,n,t[a+2],23,-995338651),n=this.md5_ii(n,r,o,i,t[a+0],6,-198630844),i=this.md5_ii(i,n,r,o,t[a+7],10,1126891415),o=this.md5_ii(o,i,n,r,t[a+14],15,-1416354905),r=this.md5_ii(r,o,i,n,t[a+5],21,-57434055),n=this.md5_ii(n,r,o,i,t[a+12],6,1700485571),i=this.md5_ii(i,n,r,o,t[a+3],10,-1894986606),o=this.md5_ii(o,i,n,r,t[a+10],15,-1051523),r=this.md5_ii(r,o,i,n,t[a+1],21,-2054922799),n=this.md5_ii(n,r,o,i,t[a+8],6,1873313359),i=this.md5_ii(i,n,r,o,t[a+15],10,-30611744),o=this.md5_ii(o,i,n,r,t[a+6],15,-1560198380),r=this.md5_ii(r,o,i,n,t[a+13],21,1309151649),n=this.md5_ii(n,r,o,i,t[a+4],6,-145523070),i=this.md5_ii(i,n,r,o,t[a+11],10,-1120210379),o=this.md5_ii(o,i,n,r,t[a+2],15,718787259),r=this.md5_ii(r,o,i,n,t[a+9],21,-343485551),n=this.safe_add(n,s),r=this.safe_add(r,c),o=this.safe_add(o,l),i=this.safe_add(i,u)}return[n,r,o,i]},t.prototype.md5_cmn=function(t,e,n,r,o,i){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(r,i)),o),n)},t.prototype.md5_ff=function(t,e,n,r,o,i,a){return this.md5_cmn(e&n|~e&r,t,e,o,i,a)},t.prototype.md5_gg=function(t,e,n,r,o,i,a){return this.md5_cmn(e&r|n&~r,t,e,o,i,a)},t.prototype.md5_hh=function(t,e,n,r,o,i,a){return this.md5_cmn(e^n^r,t,e,o,i,a)},t.prototype.md5_ii=function(t,e,n,r,o,i,a){return this.md5_cmn(n^(e|~r),t,e,o,i,a)},t.prototype.safe_add=function(t,e){var n=(65535&t)+(65535&e),r=(t>>16)+(e>>16)+(n>>16);return r<<16|65535&n},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();t.Md5Util=e,__reflect(e.prototype,"qmr.Md5Util")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.getPoolBySign=function(e){return t._poolDic[e]||(t._poolDic[e]=[])},t.clearBySign=function(e){t._poolDic[e]&&(t._poolDic[e].length=0)},t._getClassSign=function(t){var e=t.name;return(""==e||void 0==e)&&(t.name=e=this.getGID()+""),e},t.getItemByClass=function(t,e){if(!this._poolDic[t])return new e;var n=this.getPoolBySign(t);if(n&&n.length){var r=n.pop();r[this.POOLSIGN]=!1}else r=new e;return r},t.recover=function(t,e){e&&(e[this.POOLSIGN]||(e[this.POOLSIGN]=!0,this.getPoolBySign(t).push(e)))},t.isInPool=function(t){return t&&t[this.POOLSIGN]?!0:!1},t.getItemByCreateFun=function(t,e,n){void 0===n&&(n=null);var r=this.getPoolBySign(t),o=r.length?r.pop():e.call(n);return o[this.POOLSIGN]=!1,o},t.getItem=function(t){var e=this.getPoolBySign(t),n=e.length?e.pop():null;return n&&(n[this.POOLSIGN]=!1),n},t.getGID=function(){return this._gid++},t.POOLSIGN="__InPool",t._poolDic={},t._gid=1,t}();t.Pool=e,__reflect(e.prototype,"qmr.Pool")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"stageWidth",{get:function(){return e.stage.stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stageHeight",{get:function(){return e.stage.stageHeight},enumerable:!0,configurable:!0}),e.setStageFrameRate=function(t){e.stage.frameRate=t},e.getStageFrameRate=function(){return e.stage.frameRate},e.init=function(n){e.stage=n;var r=e;r.maxStageWidth=Math.floor(r.DESIGN_HEIGHT/r.MIN_HW_RATIO),r.maxStageHeight=Math.floor(r.DESIGN_WIDTH*r.MAX_HW_RATIO),r.setStageFrameRate(r.FRAME_RATE),t.PlatformManager.instance.platform.canResizeStage&&r.changeStageSize(),window.addEventListener("resize",r.changeStageSize)},e.changeStageSize=function(){var n=e,r=function(){var r="",o=0,i=0,a=window.innerHeight/window.innerWidth;a>=n.MAX_HW_RATIO?(r=egret.StageScaleMode.SHOW_ALL,o=n.DESIGN_WIDTH,i=n.maxStageHeight):a>=n.STANDARD_RATIO?(r=egret.StageScaleMode.FIXED_WIDTH,o=n.DESIGN_WIDTH,i=n.DESIGN_HEIGHT):a>n.MIN_HW_RATIO?(r=egret.StageScaleMode.FIXED_HEIGHT,o=n.DESIGN_WIDTH,i=n.DESIGN_HEIGHT):(r=egret.StageScaleMode.SHOW_ALL,o=n.maxStageWidth,i=n.DESIGN_HEIGHT),n.stage.scaleMode=r,n.stage.setContentSize(o,i),t.NotifyManager.sendNotification(e.STAGE_RESIZE)};r(),"IOS"==egret.Capabilities.os.toUpperCase()&&egret.setTimeout(r,this,100)},e.stageEnable=function(t){this.stage&&(this.stage.touchChildren=t)},e.isPC=function(){for(var t=navigator.userAgent.toString(),e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=!0,r=0;r<e.length;r++)if(t.indexOf(e[r])>0){n=!1;break}return n},e.FRAME_RATE=60,e.STAGE_RESIZE="stage_resize",e.STAGE_ACTIVE="stage_active",e.STAGE_DEACTIVATE="stage_deactivate",e.DESIGN_WIDTH=750,e.DESIGN_HEIGHT=1334,e.STANDARD_RATIO=1.78,e.MAX_HW_RATIO=2.16,e.MIN_HW_RATIO=1.333,e.maxStageWidth=0,e.maxStageHeight=0,e}();t.StageUtil=e,__reflect(e.prototype,"qmr.StageUtil")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"loginPath",{get:function(){return t.PlatformConfig.webRoot+"resourceLogin/"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultPath",{get:function(){return"resourceLogin/animation/"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"rolePath",{get:function(){return t.PlatformConfig.webRoot+"avatar/role/"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"roleUiPath",{get:function(){return t.PlatformConfig.webRoot+"avatar/uiRole/"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"weaponPath",{get:function(){return t.PlatformConfig.webRoot+"avatar/weapon/"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"horsePath",{get:function(){return t.PlatformConfig.webRoot+"avatar/horse/"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"wingPath",{get:function(){return t.PlatformConfig.webRoot+"avatar/wing/"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"bg_music",{get:function(){return t.PlatformConfig.webRoot+"sound/music/"},enumerable:!0,configurable:!0}),e.getEffect_musicUrl=function(e){var n=t.PlatformConfig.webRoot+"sound/effect/";return n+e+".mp3"},Object.defineProperty(e,"itemIcon",{get:function(){return t.PlatformConfig.webRoot+"icon/item/"},enumerable:!0,configurable:!0}),e.getLoginResDir=function(){var e="resourceLogin/";return t.PlatformConfig.useCdnRes&&(e=t.PlatformConfig.webUrl+"resourceLogin/"),e},e}();t.SystemPath=e,__reflect(e.prototype,"qmr.SystemPath")}(qmr||(qmr={}));var qmr;!function(t){var e=function(){function t(){}return t.initSysInfo=function(){this.initMd()},t.initMd=function(){console.log("运行系统:"+egret.Capabilities.os);var t=window.MobileDetect;if(t){var e=navigator.userAgent,n=new t(e),r=n.os(),o="";if("iOS"==r)o=n.mobile();else if("AndroidOS"==r){var i=e.split(";"),a=this.contains(i,"Build/");o=a>-1?i[a].substring(0,i[a].indexOf("Build/")):n.mobile()}this.model=o,this.OS=r,egret.log("md:"+JSON.stringify(n)),egret.log("操作系统:"+r),egret.log("手机型号:"+o)}},t.contains=function(t,e){for(var n in t)if(t[n].indexOf(e)>0)return Number(n);return-1},t}();t.WebBrowerUtil=e,__reflect(e.prototype,"qmr.WebBrowerUtil")}(qmr||(qmr={}));